debug | INFO flwr 2024-06-26 17:22:09,434 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 17:22:11,348 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37916059239.0, 'node:__internal_head__': 1.0, 'object_store_memory': 18958029619.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-26 17:22:11,348 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 17:22:11,348 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 17:22:11,353 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 17:22:11,353 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 17:22:11,353 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 17:22:13,976 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 17:22:13,977 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 17:22:13,977 | server.py:110 | 
debug | INFO flwr 2024-06-26 17:22:13,977 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 17:22:13,977 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 17:22:14,915 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:14,915 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:15,659 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:15,659 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:16,383 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:16,383 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:17,108 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:17,108 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:17,840 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:17,841 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:18,566 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:18,567 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:19,287 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:19,288 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:20,015 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:20,015 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:20,742 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:20,743 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:21,421 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:21,421 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | INFO flwr 2024-06-26 17:22:21,422 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 17:22:21,422 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 17:22:22,192 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:22,192 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:22,890 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:22,891 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:23,572 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:23,572 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:24,255 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:24,256 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:24,940 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:24,940 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:25,628 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:25,628 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:26,323 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:26,323 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:27,042 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:27,042 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:27,747 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:27,747 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:28,401 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:28,401 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | INFO flwr 2024-06-26 17:47:15,620 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 17:47:17,507 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0, 'memory': 37916730164.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'object_store_memory': 18958365081.0}
debug | INFO flwr 2024-06-26 17:47:17,507 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 17:47:17,507 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 17:47:17,512 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 17:47:17,513 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 17:47:17,513 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 17:47:20,129 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 17:47:20,129 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 17:47:20,129 | server.py:110 | 
debug | INFO flwr 2024-06-26 17:47:20,129 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 17:47:20,129 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 17:47:21,031 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:21,032 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:21,745 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:21,745 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:22,433 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:22,433 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:23,128 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:23,128 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:23,831 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:23,831 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:24,510 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:24,510 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:25,189 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:25,189 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:25,873 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:25,873 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:26,558 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:26,558 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:27,203 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:27,203 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | INFO flwr 2024-06-26 17:47:33,258 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 17:47:35,164 | app.py:228 | Flower VCE: Ray initialized with resources: {'GPU': 1.0, 'accelerator_type:G': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'object_store_memory': 18957894451.0, 'node:__internal_head__': 1.0, 'memory': 37915788903.0}
debug | INFO flwr 2024-06-26 17:47:35,164 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 17:47:35,164 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 17:47:35,169 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 17:47:35,169 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 17:47:35,170 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 17:47:37,742 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 17:47:37,742 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 17:47:37,742 | server.py:110 | 
debug | INFO flwr 2024-06-26 17:47:37,742 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 17:47:37,742 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | INFO flwr 2024-06-26 17:52:45,121 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 17:52:47,014 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'memory': 37916356608.0, 'object_store_memory': 18958178304.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0}
debug | INFO flwr 2024-06-26 17:52:47,014 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 17:52:47,014 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 17:52:47,019 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 17:52:47,019 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 17:52:47,019 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 17:52:49,612 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 17:52:49,612 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 17:52:49,612 | server.py:110 | 
debug | INFO flwr 2024-06-26 17:52:49,612 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 17:52:49,612 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | INFO flwr 2024-06-26 17:53:38,334 | server.py:238 | aggregate_fit: received 10 results and 0 failures
debug | WARNING flwr 2024-06-26 17:53:38,751 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-26 17:53:38,752 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | INFO flwr 2024-06-26 18:20:03,857 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:20:05,753 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18957782630.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0, 'memory': 37915565262.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-26 18:20:05,753 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:20:05,753 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:20:05,758 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:20:05,758 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:20:05,758 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:20:08,362 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:20:08,362 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:20:08,362 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:20:08,362 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:20:08,362 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | INFO flwr 2024-06-26 18:20:57,749 | server.py:238 | aggregate_fit: received 10 results and 0 failures
debug | WARNING flwr 2024-06-26 18:20:58,148 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-26 18:20:58,149 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | INFO flwr 2024-06-26 18:28:24,587 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:28:26,497 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'object_store_memory': 18957180518.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'memory': 37914361038.0}
debug | INFO flwr 2024-06-26 18:28:26,498 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:28:26,498 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:28:26,502 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:28:26,503 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:28:26,503 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:28:29,112 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:28:29,112 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:28:29,112 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:28:29,112 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:28:29,113 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:28:30,033 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:30,033 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:30,729 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:30,729 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:31,435 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:31,435 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:32,162 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:32,162 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:32,910 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:32,911 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:33,608 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:33,608 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:34,316 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:34,316 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:35,057 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:35,057 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:35,765 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:35,765 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:36,442 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:36,442 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | INFO flwr 2024-06-26 18:28:36,443 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:28:36,443 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:28:37,199 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:37,199 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:37,873 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:37,873 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:38,540 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:38,541 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:39,211 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:39,211 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:39,879 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:39,880 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:40,554 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:40,554 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:41,219 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:41,220 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:41,891 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:41,891 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:42,582 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:42,582 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:43,217 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:43,218 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | INFO flwr 2024-06-26 18:28:43,218 | server.py:190 | aggregate_evaluate: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:28:43,218 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:28:43,218 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-26 18:28:43,218 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:28:43,997 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:43,997 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:44,712 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:44,712 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:45,415 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:45,415 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:46,116 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:46,116 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:46,810 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:46,810 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:47,528 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:47,528 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:48,236 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:48,236 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:48,943 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:48,944 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | INFO flwr 2024-06-26 18:28:54,667 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:28:56,582 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37912970036.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'object_store_memory': 18956485017.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0}
debug | INFO flwr 2024-06-26 18:28:56,582 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:28:56,582 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:28:56,587 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:28:56,587 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:28:56,587 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:28:59,183 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:28:59,183 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:28:59,183 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:28:59,183 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:28:59,183 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:29:00,128 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:00,128 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:00,833 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:00,833 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:01,540 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:01,540 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:02,245 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:02,245 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:02,975 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:02,976 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:03,689 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:03,689 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:04,402 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:04,403 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:05,113 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:05,113 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:05,841 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:05,841 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:06,507 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:06,507 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | INFO flwr 2024-06-26 18:29:06,507 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:29:06,507 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:29:07,284 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:07,284 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:07,989 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:07,989 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:08,672 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:08,672 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:09,346 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:09,346 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:10,028 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:10,028 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:10,699 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:10,699 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:11,385 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:11,385 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:12,086 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:12,086 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:12,802 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:12,802 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:13,466 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:13,467 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | INFO flwr 2024-06-26 18:29:22,693 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:29:24,586 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:172.17.0.2': 1.0, 'CPU': 11.0, 'memory': 37911991911.0, 'node:__internal_head__': 1.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'object_store_memory': 18955995955.0}
debug | INFO flwr 2024-06-26 18:29:24,586 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:29:24,586 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:29:24,591 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:29:24,592 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:29:24,592 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:29:27,190 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:29:27,190 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:29:27,190 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:29:27,190 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:29:27,190 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:29:28,130 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:28,131 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:28,839 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:28,839 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:29,547 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:29,547 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:30,266 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:30,267 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:30,978 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:30,978 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:31,704 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:31,704 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:32,404 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:32,404 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:33,128 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:33,128 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:33,838 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:33,838 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:34,514 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:34,514 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | INFO flwr 2024-06-26 18:29:34,514 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:29:34,514 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:29:35,271 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:35,271 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:35,982 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:35,982 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:36,646 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:36,646 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:37,313 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:37,313 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:37,990 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:37,991 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:38,675 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:38,675 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:39,356 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:39,356 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:40,024 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:40,024 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:40,720 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:40,720 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:41,383 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:41,383 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | INFO flwr 2024-06-26 18:29:51,105 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:29:52,982 | app.py:228 | Flower VCE: Ray initialized with resources: {'GPU': 1.0, 'accelerator_type:G': 1.0, 'object_store_memory': 18956427264.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'node:__internal_head__': 1.0, 'memory': 37912854528.0}
debug | INFO flwr 2024-06-26 18:29:52,983 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:29:52,983 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:29:52,988 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:29:52,988 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:29:52,988 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:29:55,614 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:29:55,614 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:29:55,614 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:29:55,614 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:29:55,614 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:29:56,553 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:29:56,554 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:29:57,278 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:29:57,278 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:29:58,003 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:29:58,003 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:29:58,715 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:29:58,715 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:29:59,419 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:29:59,419 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:30:00,111 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:30:00,111 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:30:00,813 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:30:00,813 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:30:01,496 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:30:01,497 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:30:02,200 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:30:02,200 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:30:02,858 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:30:02,858 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | INFO flwr 2024-06-26 18:30:38,690 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:30:40,592 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37912829952.0, 'object_store_memory': 18956414976.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'node:__internal_head__': 1.0}
debug | INFO flwr 2024-06-26 18:30:40,592 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:30:40,592 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:30:40,597 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:30:40,597 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:30:40,597 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:30:43,180 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:30:43,180 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:30:43,180 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:30:43,180 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:30:43,180 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:30:44,102 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:44,102 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:44,783 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:44,783 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:45,478 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:45,478 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:46,190 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:46,190 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:46,910 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:46,910 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:47,607 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:47,607 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:48,286 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:48,286 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:48,977 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:48,978 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:49,673 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:49,673 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:50,328 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:50,328 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:30:50,328 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:30:50,328 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:30:51,085 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:51,085 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:51,760 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:51,761 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:52,443 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:52,443 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:53,106 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:53,106 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:53,776 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:53,776 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:54,443 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:54,443 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:55,127 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:55,127 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:55,812 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:55,813 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:56,515 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:56,515 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:57,184 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:57,184 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:31:30,165 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:31:32,062 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'memory': 37912768512.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'object_store_memory': 18956384256.0}
debug | INFO flwr 2024-06-26 18:31:32,063 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:31:32,063 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:31:32,068 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:31:32,068 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:31:32,068 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:31:34,699 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:31:34,699 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:31:34,699 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:31:34,699 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:31:34,699 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:31:35,619 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:35,620 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:36,340 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:36,340 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:37,066 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:37,066 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:37,793 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:37,793 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:38,545 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:38,545 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:39,252 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:39,252 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:39,973 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:39,974 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:40,689 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:40,689 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:41,398 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:41,398 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:42,069 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:42,070 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:31:42,070 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:31:42,070 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:31:42,816 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:42,817 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:43,480 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:43,481 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:44,137 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:44,137 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:44,816 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:44,816 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:45,485 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:45,485 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:46,154 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:46,154 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:46,821 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:46,821 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:47,519 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:47,519 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:48,209 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:48,209 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:48,866 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:48,866 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:31:48,867 | server.py:190 | aggregate_evaluate: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:31:48,867 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:31:48,867 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-26 18:31:48,867 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:31:49,592 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:49,592 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:50,301 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:50,301 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:51,013 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:51,013 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:51,702 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:51,703 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:52,419 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:52,419 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:53,112 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:53,112 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:53,814 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:53,814 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:54,516 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:54,516 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:55,207 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:55,207 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:55,872 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:55,872 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:31:55,872 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:31:55,873 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:31:56,601 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:56,601 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:57,270 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:57,270 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:57,944 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:57,944 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:58,624 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:58,624 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:59,295 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:59,295 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:59,966 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:59,966 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:00,642 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:00,642 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:01,311 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:01,311 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:01,991 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:01,992 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:02,673 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:02,673 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:32:02,673 | server.py:190 | aggregate_evaluate: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:32:02,673 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:32:02,673 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-26 18:32:02,673 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:32:03,386 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:03,386 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:04,059 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:04,059 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:04,738 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:04,738 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:05,412 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:05,412 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:06,084 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:06,084 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:06,768 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:06,769 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:07,450 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:07,450 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:08,123 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:08,123 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:08,801 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:08,801 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:09,441 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:09,441 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:32:18,808 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:32:20,678 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18954789273.0, 'node:__internal_head__': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'memory': 37909578548.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-26 18:32:20,678 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:32:20,678 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:32:20,686 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:32:20,686 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:32:20,686 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:32:23,311 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:32:23,312 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:32:23,312 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:32:23,312 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:32:23,312 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:32:24,257 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:24,257 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:24,971 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:24,972 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:25,688 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:25,688 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:26,421 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:26,421 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:27,156 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:27,156 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:27,864 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:27,864 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:28,577 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:28,577 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:29,298 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:29,298 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:30,008 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:30,008 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:30,678 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:30,678 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:32:30,678 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:32:30,679 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:32:31,427 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:31,427 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:32,092 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:32,092 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:32,755 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:32,755 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:33,429 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:33,429 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:34,088 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:34,088 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:34,748 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:34,748 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:35,434 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:35,434 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:32:41,404 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:32:43,335 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'memory': 37909291008.0, 'object_store_memory': 18954645504.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-26 18:32:43,335 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:32:43,335 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:32:43,340 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:32:43,340 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:32:43,340 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:32:45,941 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:32:45,941 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:32:45,941 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:32:45,941 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:32:45,941 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:32:46,867 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:46,867 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:47,577 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:47,577 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:48,291 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:48,291 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:49,003 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:49,003 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:49,756 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:49,756 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:50,474 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:50,474 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:51,184 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:51,184 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:51,876 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:51,876 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:52,568 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:52,568 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:53,253 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:53,253 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:32:53,253 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:32:53,253 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:32:54,033 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:54,033 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:54,707 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:54,707 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:55,404 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:55,404 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:56,079 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:56,079 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:56,761 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:56,761 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:57,433 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:57,433 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:58,126 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:58,126 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:58,811 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:58,811 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:59,491 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:59,491 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:33:00,154 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:33:00,154 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:42:00,673 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:42:02,598 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18951931084.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0, 'memory': 37903862171.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'node:__internal_head__': 1.0}
debug | INFO flwr 2024-06-26 18:42:02,598 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:42:02,599 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:42:02,603 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:42:02,604 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:42:02,604 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:42:05,224 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:42:05,224 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:42:05,224 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:42:05,224 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:42:05,224 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:42:06,136 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:06,136 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:06,820 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:06,820 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:07,509 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:07,509 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:08,200 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:08,200 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:08,904 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:08,904 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:09,588 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:09,588 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:10,268 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:10,268 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:10,948 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:10,949 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:11,632 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:11,633 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:12,271 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:12,271 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | INFO flwr 2024-06-26 18:42:12,271 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:42:12,271 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:42:13,017 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:13,017 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:13,677 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:13,677 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:14,335 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:14,335 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:15,012 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:15,013 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:15,670 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:15,670 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:16,319 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:16,319 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:16,971 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:16,971 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:17,633 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:17,633 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:18,323 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:18,323 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:18,955 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:18,956 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | INFO flwr 2024-06-26 18:42:18,956 | server.py:190 | aggregate_evaluate: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:42:18,956 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:42:18,956 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-26 18:42:18,956 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:42:19,668 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:19,668 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:20,366 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:20,366 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:21,041 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:21,042 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:21,710 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:21,710 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:22,386 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:22,386 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:23,070 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:23,070 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:23,748 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:23,748 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:24,422 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:24,422 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:25,094 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:25,094 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:25,743 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:25,743 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | INFO flwr 2024-06-26 18:42:25,743 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:42:25,743 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:42:26,451 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:26,451 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:27,102 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:27,102 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:27,755 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:27,756 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:28,424 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:28,424 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:29,105 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:29,105 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:29,795 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:29,795 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:30,480 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:30,480 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | INFO flwr 2024-06-26 18:42:38,283 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:42:40,171 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18950737920.0, 'node:__internal_head__': 1.0, 'memory': 37901475840.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'accelerator_type:G': 1.0, 'GPU': 1.0}
debug | INFO flwr 2024-06-26 18:42:40,171 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:42:40,171 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:42:40,176 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:42:40,177 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:42:40,177 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:42:42,790 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:42:42,790 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:42:42,790 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:42:42,790 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:42:42,790 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | INFO flwr 2024-06-26 18:43:31,632 | server.py:238 | aggregate_fit: received 10 results and 0 failures
debug | WARNING flwr 2024-06-26 18:43:32,036 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-26 18:43:32,036 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | INFO flwr 2024-06-26 18:45:10,711 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:45:12,606 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18954161356.0, 'node:__internal_head__': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'memory': 37908322715.0}
debug | INFO flwr 2024-06-26 18:45:12,606 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:45:12,606 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:45:12,611 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:45:12,611 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:45:12,611 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:45:15,225 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:45:15,225 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:45:15,225 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:45:15,225 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:45:15,226 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-26 18:46:01,835 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | WARNING flwr 2024-06-26 18:46:01,936 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-26 18:46:01,937 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-26 18:46:20,298 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | WARNING flwr 2024-06-26 18:46:20,298 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-26 18:46:20,298 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:46:20,298 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-26 18:46:20,298 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-26 18:47:06,341 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-26 18:47:06,438 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-26 18:47:24,783 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-26 18:47:24,783 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:47:24,783 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-26 18:47:24,783 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-26 18:48:10,711 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-26 18:48:10,780 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-26 18:48:28,931 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-26 18:48:28,933 | server.py:494 | 
debug | INFO flwr 2024-06-26 18:48:28,933 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-26 18:48:28,933 | server.py:496 | Run finished 3 round(s) in 193.71s
debug | INFO flwr 2024-06-26 18:48:28,933 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-26 18:48:28,934 | server.py:498 | 		round 1: 5.985895192623138
debug | INFO flwr 2024-06-26 18:48:28,934 | server.py:498 | 		round 2: 5.86846284866333
debug | INFO flwr 2024-06-26 18:48:28,934 | server.py:498 | 		round 3: 5.820194244384766
debug | INFO flwr 2024-06-26 18:48:28,934 | server.py:499 | 
debug | INFO flwr 2024-06-27 20:11:05,683 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 20:11:07,584 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37980055143.0, 'object_store_memory': 18990027571.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'node:__internal_head__': 1.0}
debug | INFO flwr 2024-06-27 20:11:07,584 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 20:11:07,584 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 20:11:07,589 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 20:11:07,589 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 20:11:07,589 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 20:11:10,213 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 20:11:10,213 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-27 20:11:10,213 | server.py:110 | 
debug | INFO flwr 2024-06-27 20:11:10,213 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-27 20:11:10,213 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 20:11:56,855 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | WARNING flwr 2024-06-27 20:11:56,956 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-27 20:11:56,957 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 20:12:15,452 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | WARNING flwr 2024-06-27 20:12:15,452 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-27 20:12:15,452 | server.py:110 | 
debug | INFO flwr 2024-06-27 20:12:15,452 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-27 20:12:15,452 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 20:13:01,816 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 20:13:01,913 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 20:13:20,419 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 20:13:20,419 | server.py:110 | 
debug | INFO flwr 2024-06-27 20:13:20,419 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-27 20:13:20,419 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 20:14:06,320 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 20:14:06,390 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 20:14:24,712 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:494 | 
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:496 | Run finished 3 round(s) in 194.50s
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:498 | 		round 1: 5.971367681026459
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:498 | 		round 2: 5.859543812274933
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:498 | 		round 3: 5.822723925113678
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:499 | 
debug | INFO flwr 2024-06-27 22:18:07,092 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:18:08,972 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18992866099.0, 'node:__internal_head__': 1.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'memory': 37985732199.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0}
debug | INFO flwr 2024-06-27 22:18:08,972 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:18:08,972 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:18:08,977 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:18:08,977 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:18:08,977 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:18:11,577 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:18:11,578 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:18:11,601 | app.py:328 | SimCLRPredictor.set_encoder_parameters() takes 1 positional argument but 2 were given
debug | ERROR flwr 2024-06-27 22:18:11,601 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 38, in evaluate
    self.update_encoder(parameters)
  File "/root/src/fedSSL/server.py", line 99, in update_encoder
    self.simclr_predictor.set_encoder_parameters(weights)
TypeError: SimCLRPredictor.set_encoder_parameters() takes 1 positional argument but 2 were given

debug | ERROR flwr 2024-06-27 22:18:11,601 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:18:35,058 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:18:36,970 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37986368718.0, 'node:__internal_head__': 1.0, 'object_store_memory': 18993184358.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0, 'accelerator_type:G': 1.0, 'GPU': 1.0}
debug | INFO flwr 2024-06-27 22:18:36,970 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:18:36,970 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:18:36,975 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:18:36,975 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:18:36,975 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:18:39,548 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:18:39,548 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:18:39,571 | app.py:328 | 'SimCLR' object has no attribute 'set_weights'
debug | ERROR flwr 2024-06-27 22:18:39,572 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 38, in evaluate
    self.update_encoder(parameters)
  File "/root/src/fedSSL/server.py", line 99, in update_encoder
    self.simclr_predictor.set_encoder_parameters(weights)
  File "/root/src/fedSSL/model.py", line 132, in set_encoder_parameters
    self.simclr.set_weights(weights)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'SimCLR' object has no attribute 'set_weights'

debug | ERROR flwr 2024-06-27 22:18:39,572 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:19:45,601 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:19:47,540 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18993455923.0, 'node:__internal_head__': 1.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'memory': 37986911847.0}
debug | INFO flwr 2024-06-27 22:19:47,540 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:19:47,540 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:19:47,545 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:19:47,545 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:19:47,545 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:19:50,152 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:19:50,152 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:19:50,176 | app.py:328 | name 'parameters' is not defined
debug | ERROR flwr 2024-06-27 22:19:50,177 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 38, in evaluate
    self.update_encoder(parameters)
  File "/root/src/fedSSL/server.py", line 99, in update_encoder
    self.simclr_predictor.set_encoder_parameters(weights)
  File "/root/src/fedSSL/model.py", line 133, in set_encoder_parameters
    params_dict = zip(self.simclr.state_dict().keys(), parameters)
NameError: name 'parameters' is not defined

debug | ERROR flwr 2024-06-27 22:19:50,177 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:20:02,149 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:20:04,062 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 19011311616.0, 'node:__internal_head__': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'memory': 38022623232.0}
debug | INFO flwr 2024-06-27 22:20:04,062 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:20:04,062 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:20:04,067 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:20:04,067 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:20:04,067 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:20:06,622 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:20:06,622 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:20:49,290 | app.py:328 | name 'output' is not defined
debug | ERROR flwr 2024-06-27 22:20:49,290 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 41, in evaluate
    accuracy = self.evaluate()
  File "/root/src/fedSSL/server.py", line 85, in evaluate
    predicted = torch.max(output, 1)
NameError: name 'output' is not defined

debug | ERROR flwr 2024-06-27 22:20:49,290 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:21:05,697 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:21:07,596 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37987302606.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'object_store_memory': 18993651302.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'node:__internal_head__': 1.0}
debug | INFO flwr 2024-06-27 22:21:07,596 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:21:07,596 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:21:07,601 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:21:07,601 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:21:07,601 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:21:10,170 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:21:10,170 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:21:52,467 | app.py:328 | name 'outputs' is not defined
debug | ERROR flwr 2024-06-27 22:21:52,468 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 41, in evaluate
    accuracy = self.evaluate()
  File "/root/src/fedSSL/server.py", line 87, in evaluate
    predicted = torch.max(outputs, 1)
NameError: name 'outputs' is not defined

debug | ERROR flwr 2024-06-27 22:21:52,468 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:22:45,166 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:22:47,082 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37986398208.0, 'object_store_memory': 18993199104.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-27 22:22:47,082 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:22:47,082 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:22:47,087 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:22:47,087 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:22:47,087 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:22:49,653 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:22:49,653 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:23:32,194 | app.py:328 | 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-27 22:23:32,194 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 41, in evaluate
    accuracy = self.evaluate()
  File "/root/src/fedSSL/server.py", line 89, in evaluate
    total += labels.shape(0)
TypeError: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-27 22:23:32,194 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:26:45,707 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:26:47,608 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37985461863.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'node:__internal_head__': 1.0, 'object_store_memory': 18992730931.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-27 22:26:47,608 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:26:47,608 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:26:47,613 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:26:47,613 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:26:47,613 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:26:50,219 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:26:50,219 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:27:32,770 | app.py:328 | 'bool' object has no attribute 'sum'
debug | ERROR flwr 2024-06-27 22:27:32,770 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 41, in evaluate
    accuracy = self.evaluate()
  File "/root/src/fedSSL/server.py", line 90, in evaluate
    correct += (predicted == labels).sum().item()
AttributeError: 'bool' object has no attribute 'sum'

debug | ERROR flwr 2024-06-27 22:27:32,770 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:30:00,315 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:30:02,244 | app.py:228 | Flower VCE: Ray initialized with resources: {'CPU': 11.0, 'node:172.17.0.2': 1.0, 'memory': 37984016795.0, 'object_store_memory': 18992008396.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-27 22:30:02,244 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:30:02,244 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:30:02,249 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:30:02,249 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:30:02,249 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:30:04,859 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:30:04,859 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:30:55,037 | app.py:328 | 'bool' object has no attribute 'sum'
debug | ERROR flwr 2024-06-27 22:30:55,037 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 41, in evaluate
    accuracy = self.evaluate()
  File "/root/src/fedSSL/server.py", line 91, in evaluate
    correct += (predicted == labels).sum().item()
AttributeError: 'bool' object has no attribute 'sum'

debug | ERROR flwr 2024-06-27 22:30:55,037 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:31:16,411 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:31:18,299 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 38018418279.0, 'node:__internal_head__': 1.0, 'object_store_memory': 19009209139.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0, 'accelerator_type:G': 1.0, 'GPU': 1.0}
debug | INFO flwr 2024-06-27 22:31:18,299 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:31:18,299 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:31:18,304 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:31:18,304 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:31:18,304 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:31:20,857 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:31:20,857 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:31:22,682 | app.py:328 | 'bool' object has no attribute 'sum'
debug | ERROR flwr 2024-06-27 22:31:22,682 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 41, in evaluate
    accuracy = self.evaluate()
  File "/root/src/fedSSL/server.py", line 97, in evaluate
    correct += (predicted == labels).sum().item()
AttributeError: 'bool' object has no attribute 'sum'

debug | ERROR flwr 2024-06-27 22:31:22,682 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:32:02,625 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:32:04,524 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'memory': 37981394535.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'object_store_memory': 18990697267.0}
debug | INFO flwr 2024-06-27 22:32:04,524 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:32:04,524 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:32:04,529 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:32:04,529 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:32:04,529 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:32:07,107 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:32:07,107 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:32:07,488 | app.py:328 | 'torch.return_types.max' object has no attribute 'shape'
debug | ERROR flwr 2024-06-27 22:32:07,489 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 41, in evaluate
    accuracy = self.evaluate()
  File "/root/src/fedSSL/server.py", line 98, in evaluate
    print(predicted.shape)
AttributeError: 'torch.return_types.max' object has no attribute 'shape'

debug | ERROR flwr 2024-06-27 22:32:07,489 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:32:35,436 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:32:37,320 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37981613262.0, 'node:__internal_head__': 1.0, 'object_store_memory': 18990806630.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'accelerator_type:G': 1.0, 'GPU': 1.0}
debug | INFO flwr 2024-06-27 22:32:37,320 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:32:37,320 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:32:37,325 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:32:37,325 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:32:37,325 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:32:39,915 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:32:39,915 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:32:40,472 | app.py:328 | not enough values to unpack (expected 2, got 1)
debug | ERROR flwr 2024-06-27 22:32:40,472 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 170, in evaluate
    loss, metrics = eval_res
ValueError: not enough values to unpack (expected 2, got 1)

debug | ERROR flwr 2024-06-27 22:32:40,472 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:33:01,409 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:33:03,303 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:172.17.0.2': 1.0, 'CPU': 11.0, 'memory': 37981485467.0, 'object_store_memory': 18990742732.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-27 22:33:03,303 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:33:03,303 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:33:03,308 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:33:03,309 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:33:03,309 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:33:05,917 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:33:05,917 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-27 22:33:06,466 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': 0.056818181818181816}
debug | INFO flwr 2024-06-27 22:33:06,466 | server.py:110 | 
debug | INFO flwr 2024-06-27 22:33:06,466 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-27 22:33:06,466 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:34:25,980 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | WARNING flwr 2024-06-27 22:34:26,074 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-27 22:34:26,457 | server.py:129 | fit progress: (1, -1, {'accuracy': 0.125}, 79.99125635798555)
debug | INFO flwr 2024-06-27 22:34:26,457 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:34:49,243 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | WARNING flwr 2024-06-27 22:34:49,243 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-27 22:34:49,243 | server.py:110 | 
debug | INFO flwr 2024-06-27 22:34:49,243 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-27 22:34:49,243 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:36:40,481 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:36:42,388 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37799251968.0, 'node:__internal_head__': 1.0, 'object_store_memory': 18899625984.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0}
debug | INFO flwr 2024-06-27 22:36:42,388 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:36:42,388 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:36:42,393 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:36:42,393 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:36:42,393 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:36:44,964 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:36:44,964 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-27 22:36:54,658 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': 0.09197443181818182}
debug | INFO flwr 2024-06-27 22:36:54,659 | server.py:110 | 
debug | INFO flwr 2024-06-27 22:36:54,659 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-27 22:36:54,659 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:37:05,889 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | WARNING flwr 2024-06-27 22:37:05,966 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-27 22:37:15,514 | server.py:129 | fit progress: (1, -1, {'accuracy': 0.1807528409090909}, 20.855830161017366)
debug | INFO flwr 2024-06-27 22:37:15,515 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | ERROR flwr 2024-06-27 22:37:16,294 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 118, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    count += 1
UnboundLocalError: local variable 'count' referenced before assignment

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: local variable 'count' referenced before assignment

debug | ERROR flwr 2024-06-27 22:37:16,294 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 118, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    count += 1
UnboundLocalError: local variable 'count' referenced before assignment

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: local variable 'count' referenced before assignment
debug | ERROR flwr 2024-06-27 22:37:16,924 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 118, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    count += 1
UnboundLocalError: local variable 'count' referenced before assignment

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: local variable 'count' referenced before assignment

debug | ERROR flwr 2024-06-27 22:37:16,924 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 118, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    count += 1
UnboundLocalError: local variable 'count' referenced before assignment

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: local variable 'count' referenced before assignment
debug | INFO flwr 2024-06-27 22:37:16,924 | server.py:190 | aggregate_evaluate: received 0 results and 2 failures
debug | INFO flwr 2024-06-27 22:37:16,924 | server.py:110 | 
debug | INFO flwr 2024-06-27 22:37:16,924 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-27 22:37:16,924 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:37:27,713 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 22:37:37,301 | server.py:129 | fit progress: (2, -1, {'accuracy': 0.3016690340909091}, 42.64205834304448)
debug | INFO flwr 2024-06-27 22:37:37,301 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | ERROR flwr 2024-06-27 22:37:38,036 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 118, in evaluate
    # self.simclr_predictor = train_predictor(self.simclr, self.trainloader, self.optimizer, nn.CrossEntropyLoss(reduction='mean'), epochs=1)
  File "/root/src/fedSSL/client.py", line 72, in test
UnboundLocalError: local variable 'count' referenced before assignment

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: local variable 'count' referenced before assignment

debug | ERROR flwr 2024-06-27 22:37:38,036 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 118, in evaluate
    # self.simclr_predictor = train_predictor(self.simclr, self.trainloader, self.optimizer, nn.CrossEntropyLoss(reduction='mean'), epochs=1)
  File "/root/src/fedSSL/client.py", line 72, in test
UnboundLocalError: local variable 'count' referenced before assignment

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: local variable 'count' referenced before assignment
debug | ERROR flwr 2024-06-27 22:37:38,694 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 118, in evaluate
    # self.simclr_predictor = train_predictor(self.simclr, self.trainloader, self.optimizer, nn.CrossEntropyLoss(reduction='mean'), epochs=1)
  File "/root/src/fedSSL/client.py", line 72, in test
UnboundLocalError: local variable 'count' referenced before assignment

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: local variable 'count' referenced before assignment

debug | ERROR flwr 2024-06-27 22:37:38,694 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 118, in evaluate
    # self.simclr_predictor = train_predictor(self.simclr, self.trainloader, self.optimizer, nn.CrossEntropyLoss(reduction='mean'), epochs=1)
  File "/root/src/fedSSL/client.py", line 72, in test
UnboundLocalError: local variable 'count' referenced before assignment

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=265133, ip=172.17.0.2, actor_id=e17ec4e368956af027bca30001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x76e5501cdea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: local variable 'count' referenced before assignment
debug | INFO flwr 2024-06-27 22:37:38,694 | server.py:190 | aggregate_evaluate: received 0 results and 2 failures
debug | INFO flwr 2024-06-27 22:37:38,694 | server.py:110 | 
debug | INFO flwr 2024-06-27 22:37:38,694 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-27 22:37:38,694 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:37:46,191 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:37:48,127 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18989228851.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'memory': 37978457703.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'node:__internal_head__': 1.0}
debug | INFO flwr 2024-06-27 22:37:48,127 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:37:48,128 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:37:48,132 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:37:48,133 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:37:48,133 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:37:50,737 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:37:50,737 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-27 22:38:00,358 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': 0.10884232954545454}
debug | INFO flwr 2024-06-27 22:38:00,358 | server.py:110 | 
debug | INFO flwr 2024-06-27 22:38:00,359 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-27 22:38:00,359 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:38:11,469 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | WARNING flwr 2024-06-27 22:38:11,560 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-27 22:38:20,843 | server.py:129 | fit progress: (1, -1, {'accuracy': 0.234375}, 20.48469698196277)
debug | INFO flwr 2024-06-27 22:38:20,843 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:38:31,526 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | WARNING flwr 2024-06-27 22:38:31,526 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-27 22:38:31,526 | server.py:110 | 
debug | INFO flwr 2024-06-27 22:38:31,526 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-27 22:38:31,526 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:38:42,502 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 22:38:51,898 | server.py:129 | fit progress: (2, -1, {'accuracy': 0.3318536931818182}, 51.539253128983546)
debug | INFO flwr 2024-06-27 22:38:51,898 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:39:02,520 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 22:39:02,520 | server.py:110 | 
debug | INFO flwr 2024-06-27 22:39:02,520 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-27 22:39:02,521 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:39:13,377 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 22:39:22,937 | server.py:129 | fit progress: (3, -1, {'accuracy': 0.40092329545454547}, 82.57827791495947)
debug | INFO flwr 2024-06-27 22:39:22,937 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:39:33,475 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:494 | 
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:496 | Run finished 3 round(s) in 93.12s
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:498 | 		round 1: 7.110887598991394
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:498 | 		round 2: 6.836659336090088
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:498 | 		round 3: 6.705723214149475
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:498 | 	History (loss, centralized):
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:498 | 		round 0: -1
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:498 | 		round 1: -1
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:498 | 		round 2: -1
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:498 | 		round 3: -1
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:498 | 	History (metrics, centralized):
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:498 | 	{'accuracy': [(0, 0.10884232954545454),
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:498 | 	              (1, 0.234375),
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:498 | 	              (2, 0.3318536931818182),
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:498 | 	              (3, 0.40092329545454547)]}
debug | INFO flwr 2024-06-27 22:39:33,478 | server.py:499 | 
debug | INFO flwr 2024-06-27 22:43:53,098 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:43:54,998 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'memory': 37979657012.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'object_store_memory': 18989828505.0, 'accelerator_type:G': 1.0, 'GPU': 1.0}
debug | INFO flwr 2024-06-27 22:43:54,998 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:43:54,998 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:43:55,004 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:43:55,004 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:43:55,004 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:43:57,589 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:43:57,589 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:44:39,796 | app.py:328 | Expected floating point type for target with class probabilities, got Long
debug | ERROR flwr 2024-06-27 22:44:39,797 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 44, in evaluate
    accuracy = self.evaluate()
  File "/root/src/fedSSL/server.py", line 101, in evaluate
    loss += self.criterion(predicted, labels)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: Expected floating point type for target with class probabilities, got Long

debug | ERROR flwr 2024-06-27 22:44:39,797 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:45:34,193 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:45:36,111 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37979794638.0, 'object_store_memory': 18989897318.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'node:__internal_head__': 1.0}
debug | INFO flwr 2024-06-27 22:45:36,112 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:45:36,112 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:45:36,116 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:45:36,117 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:45:36,117 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:45:38,748 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:45:38,748 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-27 22:46:18,064 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:46:19,980 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'object_store_memory': 18989581516.0, 'memory': 37979163035.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-27 22:46:19,980 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:46:19,980 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:46:19,985 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:46:19,985 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:46:19,985 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:46:22,564 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:46:22,564 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-27 22:47:12,952 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': (tensor(0.0040, device='cuda:0'), 0.3027)}
debug | INFO flwr 2024-06-27 22:47:12,953 | server.py:110 | 
debug | INFO flwr 2024-06-27 22:47:12,953 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-27 22:47:12,953 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:47:58,925 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | WARNING flwr 2024-06-27 22:47:59,019 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-27 22:48:49,095 | server.py:129 | fit progress: (1, -1, {'accuracy': (tensor(0.0030, device='cuda:0'), 0.4779)}, 96.14160640595946)
debug | INFO flwr 2024-06-27 22:48:49,096 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | ERROR flwr 2024-06-27 22:48:49,827 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=270866, ip=172.17.0.2, actor_id=bf18ea18c0637be71666570a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x735a4c4cdf30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 123, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 74, in test
    # if(batch % (print_interval * num_batches) == 0):
NameError: name 'num_batches' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=270866, ip=172.17.0.2, actor_id=bf18ea18c0637be71666570a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x735a4c4cdf30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'num_batches' is not defined

debug | ERROR flwr 2024-06-27 22:48:49,827 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=270866, ip=172.17.0.2, actor_id=bf18ea18c0637be71666570a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x735a4c4cdf30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 123, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 74, in test
    # if(batch % (print_interval * num_batches) == 0):
NameError: name 'num_batches' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=270866, ip=172.17.0.2, actor_id=bf18ea18c0637be71666570a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x735a4c4cdf30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'num_batches' is not defined
debug | ERROR flwr 2024-06-27 22:48:50,482 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=270866, ip=172.17.0.2, actor_id=bf18ea18c0637be71666570a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x735a4c4cdf30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 123, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 74, in test
    # if(batch % (print_interval * num_batches) == 0):
NameError: name 'num_batches' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=270866, ip=172.17.0.2, actor_id=bf18ea18c0637be71666570a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x735a4c4cdf30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'num_batches' is not defined

debug | ERROR flwr 2024-06-27 22:48:50,482 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=270866, ip=172.17.0.2, actor_id=bf18ea18c0637be71666570a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x735a4c4cdf30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 123, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 74, in test
    # if(batch % (print_interval * num_batches) == 0):
NameError: name 'num_batches' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=270866, ip=172.17.0.2, actor_id=bf18ea18c0637be71666570a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x735a4c4cdf30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'num_batches' is not defined
debug | INFO flwr 2024-06-27 22:48:50,482 | server.py:190 | aggregate_evaluate: received 0 results and 2 failures
debug | INFO flwr 2024-06-27 22:48:50,482 | server.py:110 | 
debug | INFO flwr 2024-06-27 22:48:50,482 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-27 22:48:50,482 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:49:35,961 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 22:50:00,117 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:50:02,030 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18886571212.0, 'node:__internal_head__': 1.0, 'memory': 37773142427.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0}
debug | INFO flwr 2024-06-27 22:50:02,030 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:50:02,030 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:50:02,035 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:50:02,035 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:50:02,035 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:50:04,644 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:50:04,645 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-27 22:50:55,072 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': (tensor(0.0040, device='cuda:0'), 0.2985)}
debug | INFO flwr 2024-06-27 22:50:55,073 | server.py:110 | 
debug | INFO flwr 2024-06-27 22:50:55,073 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-27 22:50:55,073 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:51:41,426 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | WARNING flwr 2024-06-27 22:51:41,518 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-27 22:52:30,854 | server.py:129 | fit progress: (1, -1, {'accuracy': (tensor(0.0029, device='cuda:0'), 0.4767)}, 95.78077190800104)
debug | INFO flwr 2024-06-27 22:52:30,855 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:52:49,422 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | WARNING flwr 2024-06-27 22:52:49,422 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-27 22:52:49,422 | server.py:110 | 
debug | INFO flwr 2024-06-27 22:52:49,422 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-27 22:52:49,422 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:53:36,056 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 22:54:25,480 | server.py:129 | fit progress: (2, -1, {'accuracy': (tensor(0.0027, device='cuda:0'), 0.5093)}, 210.40664819598896)
debug | INFO flwr 2024-06-27 22:54:25,481 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:54:43,763 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 22:54:43,763 | server.py:110 | 
debug | INFO flwr 2024-06-27 22:54:43,763 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-27 22:54:43,763 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:55:29,448 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 22:56:19,757 | server.py:129 | fit progress: (3, -1, {'accuracy': (tensor(0.0026, device='cuda:0'), 0.5279)}, 324.68334057100583)
debug | INFO flwr 2024-06-27 22:56:19,757 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 22:56:38,374 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 22:56:38,376 | server.py:494 | 
debug | INFO flwr 2024-06-27 22:56:38,376 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-27 22:56:38,377 | server.py:496 | Run finished 3 round(s) in 343.30s
debug | INFO flwr 2024-06-27 22:56:38,382 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-27 22:56:38,382 | server.py:498 | 		round 1: 5.96146422624588
debug | INFO flwr 2024-06-27 22:56:38,382 | server.py:498 | 		round 2: 5.8617241978645325
debug | INFO flwr 2024-06-27 22:56:38,382 | server.py:498 | 		round 3: 5.810686755180359
debug | INFO flwr 2024-06-27 22:56:38,382 | server.py:498 | 	History (loss, centralized):
debug | INFO flwr 2024-06-27 22:56:38,383 | server.py:498 | 		round 0: -1
debug | INFO flwr 2024-06-27 22:56:38,383 | server.py:498 | 		round 1: -1
debug | INFO flwr 2024-06-27 22:56:38,383 | server.py:498 | 		round 2: -1
debug | INFO flwr 2024-06-27 22:56:38,383 | server.py:498 | 		round 3: -1
debug | INFO flwr 2024-06-27 22:56:38,383 | server.py:498 | 	History (metrics, centralized):
debug | INFO flwr 2024-06-27 22:56:38,383 | server.py:498 | 	{'accuracy': [(0, (tensor(0.0040, device='cuda:0'), 0.2985)),
debug | INFO flwr 2024-06-27 22:56:38,383 | server.py:498 | 	              (1, (tensor(0.0029, device='cuda:0'), 0.4767)),
debug | INFO flwr 2024-06-27 22:56:38,383 | server.py:498 | 	              (2, (tensor(0.0027, device='cuda:0'), 0.5093)),
debug | INFO flwr 2024-06-27 22:56:38,383 | server.py:498 | 	              (3, (tensor(0.0026, device='cuda:0'), 0.5279))]}
debug | INFO flwr 2024-06-27 22:56:38,383 | server.py:499 | 
debug | INFO flwr 2024-06-28 00:06:32,396 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-28 00:06:34,285 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 38013023847.0, 'object_store_memory': 19006511923.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0, 'node:__internal_head__': 1.0}
debug | INFO flwr 2024-06-28 00:06:34,286 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-28 00:06:34,286 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-28 00:06:34,290 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-28 00:06:34,291 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-28 00:06:34,291 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-28 00:07:22,215 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-28 00:07:24,106 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37943085467.0, 'node:__internal_head__': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'object_store_memory': 18971542732.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-28 00:07:24,106 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-28 00:07:24,106 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-28 00:07:24,111 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-28 00:07:24,112 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-28 00:07:24,112 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-28 00:07:26,962 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-28 00:07:26,962 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-28 00:08:17,757 | server.py:97 | initial parameters (loss, other metrics): tensor(0.0036, device='cuda:0'), {'accuracy': 0.383}
debug | INFO flwr 2024-06-28 00:08:17,770 | server.py:110 | 
debug | INFO flwr 2024-06-28 00:08:17,770 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-28 00:08:17,770 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:09:05,767 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | WARNING flwr 2024-06-28 00:09:05,951 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 00:09:56,593 | server.py:129 | fit progress: (1, tensor(0.0027, device='cuda:0'), {'accuracy': 0.5208}, 98.82242792396573)
debug | INFO flwr 2024-06-28 00:09:56,593 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:10:15,939 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | WARNING flwr 2024-06-28 00:10:15,939 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 00:10:15,939 | server.py:110 | 
debug | INFO flwr 2024-06-28 00:10:15,939 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-28 00:10:15,939 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:11:03,370 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:11:53,286 | server.py:129 | fit progress: (2, tensor(0.0025, device='cuda:0'), {'accuracy': 0.561}, 215.5157219079556)
debug | INFO flwr 2024-06-28 00:11:53,287 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:12:12,827 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:12:12,827 | server.py:110 | 
debug | INFO flwr 2024-06-28 00:12:12,827 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-28 00:12:12,827 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:13:00,910 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:13:51,062 | server.py:129 | fit progress: (3, tensor(0.0023, device='cuda:0'), {'accuracy': 0.5824}, 333.29196200799197)
debug | INFO flwr 2024-06-28 00:13:51,063 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:14:10,511 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:14:10,515 | server.py:494 | 
debug | INFO flwr 2024-06-28 00:14:10,515 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-28 00:14:10,516 | server.py:496 | Run finished 3 round(s) in 352.74s
debug | INFO flwr 2024-06-28 00:14:10,518 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-28 00:14:10,518 | server.py:498 | 		round 1: 5.938434493541718
debug | INFO flwr 2024-06-28 00:14:10,518 | server.py:498 | 		round 2: 5.768706691265106
debug | INFO flwr 2024-06-28 00:14:10,518 | server.py:498 | 		round 3: 5.7369923949241635
debug | INFO flwr 2024-06-28 00:14:10,518 | server.py:498 | 	History (loss, centralized):
debug | INFO flwr 2024-06-28 00:14:10,518 | server.py:498 | 		round 0: 0.003613457316532731
debug | INFO flwr 2024-06-28 00:14:10,518 | server.py:498 | 		round 1: 0.0027251210995018482
debug | INFO flwr 2024-06-28 00:14:10,518 | server.py:498 | 		round 2: 0.002497488632798195
debug | INFO flwr 2024-06-28 00:14:10,518 | server.py:498 | 		round 3: 0.0023492989130318165
debug | INFO flwr 2024-06-28 00:14:10,518 | server.py:498 | 	History (metrics, centralized):
debug | INFO flwr 2024-06-28 00:14:10,518 | server.py:498 | 	{'accuracy': [(0, 0.383), (1, 0.5208), (2, 0.561), (3, 0.5824)]}
debug | INFO flwr 2024-06-28 00:14:10,518 | server.py:499 | 
debug | INFO flwr 2024-06-28 00:15:50,656 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-28 00:15:52,553 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 38012719104.0, 'node:__internal_head__': 1.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'object_store_memory': 19006359552.0}
debug | INFO flwr 2024-06-28 00:15:52,553 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-28 00:15:52,553 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-28 00:15:52,558 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-28 00:15:52,558 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-28 00:15:52,558 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-28 00:15:55,416 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-28 00:15:55,416 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-28 00:16:46,155 | server.py:97 | initial parameters (loss, other metrics): tensor(1.8098, device='cuda:0'), {'accuracy': 0.3846}
debug | INFO flwr 2024-06-28 00:16:46,170 | server.py:110 | 
debug | INFO flwr 2024-06-28 00:16:46,170 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-28 00:16:46,170 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:17:34,274 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | WARNING flwr 2024-06-28 00:17:34,461 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 00:18:24,889 | server.py:129 | fit progress: (1, tensor(1.3630, device='cuda:0'), {'accuracy': 0.5158}, 98.71855357399909)
debug | INFO flwr 2024-06-28 00:18:24,890 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:18:44,583 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | WARNING flwr 2024-06-28 00:18:44,583 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 00:18:44,583 | server.py:110 | 
debug | INFO flwr 2024-06-28 00:18:44,583 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-28 00:18:44,583 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:19:32,777 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:20:23,463 | server.py:129 | fit progress: (2, tensor(1.2433, device='cuda:0'), {'accuracy': 0.5578}, 217.29292483400786)
debug | INFO flwr 2024-06-28 00:20:23,464 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:20:42,973 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:20:42,973 | server.py:110 | 
debug | INFO flwr 2024-06-28 00:20:42,973 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-28 00:20:42,973 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:21:31,087 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:22:22,041 | server.py:129 | fit progress: (3, tensor(1.1917, device='cuda:0'), {'accuracy': 0.5788}, 335.8707748710294)
debug | INFO flwr 2024-06-28 00:22:22,042 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:22:41,483 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:22:41,489 | server.py:494 | 
debug | INFO flwr 2024-06-28 00:22:41,489 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-28 00:22:41,489 | server.py:496 | Run finished 3 round(s) in 355.31s
debug | INFO flwr 2024-06-28 00:22:41,491 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-28 00:22:41,491 | server.py:498 | 		round 1: 5.919658923149109
debug | INFO flwr 2024-06-28 00:22:41,492 | server.py:498 | 		round 2: 5.774771749973297
debug | INFO flwr 2024-06-28 00:22:41,492 | server.py:498 | 		round 3: 5.702088189125061
debug | INFO flwr 2024-06-28 00:22:41,492 | server.py:498 | 	History (loss, centralized):
debug | INFO flwr 2024-06-28 00:22:41,492 | server.py:498 | 		round 0: 1.8097895383834839
debug | INFO flwr 2024-06-28 00:22:41,492 | server.py:498 | 		round 1: 1.362991213798523
debug | INFO flwr 2024-06-28 00:22:41,492 | server.py:498 | 		round 2: 1.24333655834198
debug | INFO flwr 2024-06-28 00:22:41,492 | server.py:498 | 		round 3: 1.1916621923446655
debug | INFO flwr 2024-06-28 00:22:41,492 | server.py:498 | 	History (metrics, centralized):
debug | INFO flwr 2024-06-28 00:22:41,492 | server.py:498 | 	{'accuracy': [(0, 0.3846), (1, 0.5158), (2, 0.5578), (3, 0.5788)]}
debug | INFO flwr 2024-06-28 00:22:41,492 | server.py:499 | 
debug | INFO flwr 2024-06-28 00:30:33,158 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-28 00:30:35,054 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 19004249702.0, 'memory': 38008499406.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0}
debug | INFO flwr 2024-06-28 00:30:35,054 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-28 00:30:35,054 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-28 00:30:35,059 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-28 00:30:35,059 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-28 00:30:35,059 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-28 00:30:37,918 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-28 00:30:37,918 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-28 00:30:49,237 | server.py:97 | initial parameters (loss, other metrics): tensor(2.1680, device='cuda:0'), {'accuracy': 0.2008}
debug | INFO flwr 2024-06-28 00:30:49,250 | server.py:110 | 
debug | INFO flwr 2024-06-28 00:30:49,250 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-28 00:30:49,250 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:31:37,994 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | WARNING flwr 2024-06-28 00:31:38,180 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 00:31:49,214 | server.py:129 | fit progress: (1, tensor(1.6688, device='cuda:0'), {'accuracy': 0.4342}, 59.963891130988486)
debug | INFO flwr 2024-06-28 00:31:49,215 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:32:08,677 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | WARNING flwr 2024-06-28 00:32:08,677 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 00:32:08,677 | server.py:110 | 
debug | INFO flwr 2024-06-28 00:32:08,677 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-28 00:32:08,677 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:32:56,572 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:33:07,590 | server.py:129 | fit progress: (2, tensor(1.5464, device='cuda:0'), {'accuracy': 0.4932}, 138.33952570299152)
debug | INFO flwr 2024-06-28 00:33:07,590 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:33:27,078 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:33:27,078 | server.py:110 | 
debug | INFO flwr 2024-06-28 00:33:27,078 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-28 00:33:27,078 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:34:15,065 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:34:26,220 | server.py:129 | fit progress: (3, tensor(1.4816, device='cuda:0'), {'accuracy': 0.5208}, 216.96994055999676)
debug | INFO flwr 2024-06-28 00:34:26,221 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:34:45,679 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:34:45,684 | server.py:494 | 
debug | INFO flwr 2024-06-28 00:34:45,684 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-28 00:34:45,684 | server.py:496 | Run finished 3 round(s) in 236.43s
debug | INFO flwr 2024-06-28 00:34:45,686 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-28 00:34:45,686 | server.py:498 | 		round 1: 5.913858020305634
debug | INFO flwr 2024-06-28 00:34:45,686 | server.py:498 | 		round 2: 5.765989148616791
debug | INFO flwr 2024-06-28 00:34:45,686 | server.py:498 | 		round 3: 5.712295651435852
debug | INFO flwr 2024-06-28 00:34:45,686 | server.py:498 | 	History (loss, centralized):
debug | INFO flwr 2024-06-28 00:34:45,686 | server.py:498 | 		round 0: 2.167994499206543
debug | INFO flwr 2024-06-28 00:34:45,686 | server.py:498 | 		round 1: 1.6688177585601807
debug | INFO flwr 2024-06-28 00:34:45,686 | server.py:498 | 		round 2: 1.5463999509811401
debug | INFO flwr 2024-06-28 00:34:45,686 | server.py:498 | 		round 3: 1.4815692901611328
debug | INFO flwr 2024-06-28 00:34:45,687 | server.py:498 | 	History (metrics, centralized):
debug | INFO flwr 2024-06-28 00:34:45,687 | server.py:498 | 	{'accuracy': [(0, 0.2008), (1, 0.4342), (2, 0.4932), (3, 0.5208)]}
debug | INFO flwr 2024-06-28 00:34:45,687 | server.py:499 | 
debug | INFO flwr 2024-06-28 00:41:04,933 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-28 00:41:06,847 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 38006811035.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'node:__internal_head__': 1.0, 'object_store_memory': 19003405516.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0}
debug | INFO flwr 2024-06-28 00:41:06,847 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-28 00:41:06,847 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-28 00:41:06,852 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-28 00:41:06,852 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-28 00:41:06,852 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-28 00:41:09,697 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-28 00:41:09,697 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-28 00:46:36,988 | server.py:97 | initial parameters (loss, other metrics): tensor(0.9239, device='cuda:0'), {'accuracy': 0.6802633333333333}
debug | INFO flwr 2024-06-28 00:46:37,002 | server.py:110 | 
debug | INFO flwr 2024-06-28 00:46:37,003 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-28 00:46:37,003 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:47:25,055 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | WARNING flwr 2024-06-28 00:47:25,239 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 00:51:03,610 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-28 00:51:05,507 | app.py:228 | Flower VCE: Ray initialized with resources: {'CPU': 11.0, 'node:172.17.0.2': 1.0, 'object_store_memory': 19000967577.0, 'memory': 38001935156.0, 'node:__internal_head__': 1.0, 'accelerator_type:G': 1.0, 'GPU': 1.0}
debug | INFO flwr 2024-06-28 00:51:05,507 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-28 00:51:05,507 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-28 00:51:05,512 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-28 00:51:05,512 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-28 00:51:05,512 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-28 00:51:08,351 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-28 00:51:08,351 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-28 00:51:39,976 | server.py:97 | initial parameters (loss, other metrics): tensor(1.1446, device='cuda:0'), {'accuracy': 0.6058}
debug | INFO flwr 2024-06-28 00:51:39,991 | server.py:110 | 
debug | INFO flwr 2024-06-28 00:51:39,991 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-28 00:51:39,991 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:52:28,115 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | WARNING flwr 2024-06-28 00:52:28,298 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 00:52:59,247 | server.py:129 | fit progress: (1, tensor(1.0249, device='cuda:0'), {'accuracy': 0.64}, 79.25610015896382)
debug | INFO flwr 2024-06-28 00:52:59,248 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:53:18,968 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | WARNING flwr 2024-06-28 00:53:18,968 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 00:53:18,968 | server.py:110 | 
debug | INFO flwr 2024-06-28 00:53:18,968 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-28 00:53:18,968 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:54:07,078 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:54:38,158 | server.py:129 | fit progress: (2, tensor(0.9926, device='cuda:0'), {'accuracy': 0.647}, 178.1671820919728)
debug | INFO flwr 2024-06-28 00:54:38,159 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:54:57,788 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:54:57,788 | server.py:110 | 
debug | INFO flwr 2024-06-28 00:54:57,789 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-28 00:54:57,789 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:55:46,057 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:56:17,153 | server.py:129 | fit progress: (3, tensor(0.9717, device='cuda:0'), {'accuracy': 0.661}, 277.16142433095956)
debug | INFO flwr 2024-06-28 00:56:17,153 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 00:56:36,603 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-28 00:56:36,608 | server.py:494 | 
debug | INFO flwr 2024-06-28 00:56:36,608 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-28 00:56:36,608 | server.py:496 | Run finished 3 round(s) in 296.61s
debug | INFO flwr 2024-06-28 00:56:36,611 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-28 00:56:36,611 | server.py:498 | 		round 1: 5.917005932331085
debug | INFO flwr 2024-06-28 00:56:36,611 | server.py:498 | 		round 2: 5.772490215301514
debug | INFO flwr 2024-06-28 00:56:36,611 | server.py:498 | 		round 3: 5.715926253795624
debug | INFO flwr 2024-06-28 00:56:36,611 | server.py:498 | 	History (loss, centralized):
debug | INFO flwr 2024-06-28 00:56:36,611 | server.py:498 | 		round 0: 1.1446131467819214
debug | INFO flwr 2024-06-28 00:56:36,611 | server.py:498 | 		round 1: 1.0249470472335815
debug | INFO flwr 2024-06-28 00:56:36,611 | server.py:498 | 		round 2: 0.9925576448440552
debug | INFO flwr 2024-06-28 00:56:36,611 | server.py:498 | 		round 3: 0.9717132449150085
debug | INFO flwr 2024-06-28 00:56:36,611 | server.py:498 | 	History (metrics, centralized):
debug | INFO flwr 2024-06-28 00:56:36,611 | server.py:498 | 	{'accuracy': [(0, 0.6058), (1, 0.64), (2, 0.647), (3, 0.661)]}
debug | INFO flwr 2024-06-28 00:56:36,611 | server.py:499 | 
debug | INFO flwr 2024-06-28 01:06:00,998 | app.py:193 | Starting Flower simulation, config: num_rounds=5, no round_timeout
debug | INFO flwr 2024-06-28 01:06:02,888 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'object_store_memory': 18975219302.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'memory': 37950438606.0}
debug | INFO flwr 2024-06-28 01:06:02,888 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-28 01:06:02,888 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-28 01:06:02,893 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-28 01:06:02,893 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-28 01:06:02,893 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-28 01:06:05,726 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-28 01:06:05,726 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-28 01:06:05,770 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': -1}
debug | INFO flwr 2024-06-28 01:06:05,771 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:06:05,771 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-28 01:06:05,771 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:06:55,587 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | WARNING flwr 2024-06-28 01:06:55,989 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 01:06:56,020 | server.py:129 | fit progress: (1, -1, {'accuracy': -1}, 50.24990393401822)
debug | INFO flwr 2024-06-28 01:06:56,021 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:07:44,472 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | WARNING flwr 2024-06-28 01:07:44,472 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 01:07:44,472 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:07:44,472 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-28 01:07:44,472 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:08:34,271 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:08:34,703 | server.py:129 | fit progress: (2, -1, {'accuracy': -1}, 148.93229531799443)
debug | INFO flwr 2024-06-28 01:08:34,703 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:09:22,678 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:09:22,678 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:09:22,678 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-28 01:09:22,678 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:10:12,071 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:10:12,505 | server.py:129 | fit progress: (3, -1, {'accuracy': -1}, 246.73430090100737)
debug | INFO flwr 2024-06-28 01:10:12,505 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:11:00,686 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:11:00,687 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:11:00,687 | server.py:111 | [ROUND 4]
debug | INFO flwr 2024-06-28 01:11:00,687 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:11:50,108 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:11:50,518 | server.py:129 | fit progress: (4, -1, {'accuracy': -1}, 344.7475390130421)
debug | INFO flwr 2024-06-28 01:11:50,518 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:12:38,853 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:12:38,853 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:12:38,853 | server.py:111 | [ROUND 5]
debug | INFO flwr 2024-06-28 01:12:38,853 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:13:27,889 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:13:59,400 | server.py:129 | fit progress: (5, tensor(0.9731, device='cuda:0'), {'accuracy': 0.666}, 473.629028742027)
debug | INFO flwr 2024-06-28 01:13:59,413 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:14:47,423 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:14:47,435 | server.py:494 | 
debug | INFO flwr 2024-06-28 01:14:47,435 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-28 01:14:47,435 | server.py:496 | Run finished 5 round(s) in 521.65s
debug | INFO flwr 2024-06-28 01:14:47,439 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-28 01:14:47,439 | server.py:498 | 		round 1: 6.12578507900238
debug | INFO flwr 2024-06-28 01:14:47,439 | server.py:498 | 		round 2: 5.897843279838562
debug | INFO flwr 2024-06-28 01:14:47,439 | server.py:498 | 		round 3: 5.806778807640075
debug | INFO flwr 2024-06-28 01:14:47,440 | server.py:498 | 		round 4: 5.765784983634949
debug | INFO flwr 2024-06-28 01:14:47,440 | server.py:498 | 		round 5: 5.735882086753845
debug | INFO flwr 2024-06-28 01:14:47,440 | server.py:498 | 	History (loss, centralized):
debug | INFO flwr 2024-06-28 01:14:47,440 | server.py:498 | 		round 0: -1
debug | INFO flwr 2024-06-28 01:14:47,440 | server.py:498 | 		round 1: -1
debug | INFO flwr 2024-06-28 01:14:47,440 | server.py:498 | 		round 2: -1
debug | INFO flwr 2024-06-28 01:14:47,440 | server.py:498 | 		round 3: -1
debug | INFO flwr 2024-06-28 01:14:47,440 | server.py:498 | 		round 4: -1
debug | INFO flwr 2024-06-28 01:14:47,440 | server.py:498 | 		round 5: 0.9731290936470032
debug | INFO flwr 2024-06-28 01:14:47,440 | server.py:498 | 	History (metrics, centralized):
debug | INFO flwr 2024-06-28 01:14:47,440 | server.py:498 | 	{'accuracy': [(0, -1), (1, -1), (2, -1), (3, -1), (4, -1), (5, 0.666)]}
debug | INFO flwr 2024-06-28 01:14:47,440 | server.py:499 | 
debug | INFO flwr 2024-06-28 01:21:30,023 | app.py:193 | Starting Flower simulation, config: num_rounds=5, no round_timeout
debug | INFO flwr 2024-06-28 01:21:31,921 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'memory': 37946818560.0, 'object_store_memory': 18973409280.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0}
debug | INFO flwr 2024-06-28 01:21:31,921 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-28 01:21:31,921 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-28 01:21:31,926 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-28 01:21:31,926 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-28 01:21:31,926 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-28 01:21:34,785 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-28 01:21:34,785 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-28 01:21:34,830 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': -1}
debug | INFO flwr 2024-06-28 01:21:34,830 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:21:34,830 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-28 01:21:34,830 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | ERROR flwr 2024-06-28 01:21:36,020 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:36,020 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:36,978 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:36,978 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:37,919 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:37,919 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:38,820 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:38,820 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:39,634 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:39,634 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | INFO flwr 2024-06-28 01:21:39,634 | server.py:238 | aggregate_fit: received 0 results and 5 failures
debug | INFO flwr 2024-06-28 01:21:39,665 | server.py:129 | fit progress: (1, -1, {'accuracy': -1}, 4.835350867942907)
debug | INFO flwr 2024-06-28 01:21:39,666 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | ERROR flwr 2024-06-28 01:21:40,656 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:40,656 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:41,576 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:41,576 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:42,528 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:42,529 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:43,464 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:43,464 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:44,294 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:44,294 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | INFO flwr 2024-06-28 01:21:44,294 | server.py:190 | aggregate_evaluate: received 0 results and 5 failures
debug | INFO flwr 2024-06-28 01:21:44,294 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:21:44,294 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-28 01:21:44,294 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | ERROR flwr 2024-06-28 01:21:45,286 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:45,287 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:46,158 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:46,158 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:47,058 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:47,058 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:47,933 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:47,933 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:48,745 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:48,745 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | INFO flwr 2024-06-28 01:21:48,745 | server.py:238 | aggregate_fit: received 0 results and 5 failures
debug | INFO flwr 2024-06-28 01:21:48,776 | server.py:129 | fit progress: (2, -1, {'accuracy': -1}, 13.945481230970472)
debug | INFO flwr 2024-06-28 01:21:48,776 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | ERROR flwr 2024-06-28 01:21:49,762 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:49,762 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:50,614 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:50,614 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:51,466 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:51,466 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:52,313 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:52,313 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:53,096 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:53,096 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | INFO flwr 2024-06-28 01:21:53,096 | server.py:190 | aggregate_evaluate: received 0 results and 5 failures
debug | INFO flwr 2024-06-28 01:21:53,096 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:21:53,096 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-28 01:21:53,096 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | ERROR flwr 2024-06-28 01:21:54,003 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:54,003 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:54,861 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:54,861 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:55,721 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:55,722 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:56,567 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:56,567 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:57,376 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:57,376 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 115, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 43, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | INFO flwr 2024-06-28 01:21:57,376 | server.py:238 | aggregate_fit: received 0 results and 5 failures
debug | INFO flwr 2024-06-28 01:21:57,406 | server.py:129 | fit progress: (3, -1, {'accuracy': -1}, 22.57598391198553)
debug | INFO flwr 2024-06-28 01:21:57,406 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | ERROR flwr 2024-06-28 01:21:58,362 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:58,362 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:21:59,250 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:21:59,250 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | ERROR flwr 2024-06-28 01:22:00,139 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'

debug | ERROR flwr 2024-06-28 01:22:00,139 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 125, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 72, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 27, in forward
    self.batch_size = z_i.size(0).to(self.device)
AttributeError: 'int' object has no attribute 'to'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=311221, ip=172.17.0.2, actor_id=8f06a2772dbabbac600ec98b01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d32385c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'int' object has no attribute 'to'
debug | INFO flwr 2024-06-28 01:22:09,501 | app.py:193 | Starting Flower simulation, config: num_rounds=5, no round_timeout
debug | INFO flwr 2024-06-28 01:22:11,384 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37655044916.0, 'object_store_memory': 18827522457.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0}
debug | INFO flwr 2024-06-28 01:22:11,384 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-28 01:22:11,384 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-28 01:22:11,392 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-28 01:22:11,392 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-28 01:22:11,392 | server.py:279 | Requesting initial parameters from one random client
debug | ERROR flwr 2024-06-28 01:22:12,740 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(RaySystemError): [36mray::ClientAppActor.run()[39m (pid=312349, ip=172.17.0.2, actor_id=30a688c851e7b4305b33a68601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7365443d1f60>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RaySystemError: System error: invalid syntax (model.py, line 27)
traceback: Traceback (most recent call last):
  File "/root/src/fedSSL/client.py", line 18, in <module>
    from model import SimCLR, NTXentLoss, SimCLRPredictor
  File "/root/src/fedSSL/model.py", line 27
    self.batch_size = z_i.size(0).
                                  ^
SyntaxError: invalid syntax

debug | ERROR flwr 2024-06-28 01:22:12,740 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=312349, ip=172.17.0.2, actor_id=30a688c851e7b4305b33a68601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7365443d1f60>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RaySystemError: System error: invalid syntax (model.py, line 27)
traceback: Traceback (most recent call last):
  File "/root/src/fedSSL/client.py", line 18, in <module>
    from model import SimCLR, NTXentLoss, SimCLRPredictor
  File "/root/src/fedSSL/model.py", line 27
    self.batch_size = z_i.size(0).
                                  ^
SyntaxError: invalid syntax
debug | ERROR flwr 2024-06-28 01:22:12,740 | app.py:328 | [36mray::ClientAppActor.run()[39m (pid=312349, ip=172.17.0.2, actor_id=30a688c851e7b4305b33a68601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7365443d1f60>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RaySystemError: System error: invalid syntax (model.py, line 27)
traceback: Traceback (most recent call last):
  File "/root/src/fedSSL/client.py", line 18, in <module>
    from model import SimCLR, NTXentLoss, SimCLRPredictor
  File "/root/src/fedSSL/model.py", line 27
    self.batch_size = z_i.size(0).
                                  ^
SyntaxError: invalid syntax
debug | ERROR flwr 2024-06-28 01:22:12,740 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 93, in fit
    self.parameters = self._get_initial_parameters(server_round=0, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 282, in _get_initial_parameters
    get_parameters_res = random_client.get_parameters(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 148, in get_parameters
    message_out = self._submit_job(message, timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 87, in _submit_job
    raise ex
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(RaySystemError): [36mray::ClientAppActor.run()[39m (pid=312349, ip=172.17.0.2, actor_id=30a688c851e7b4305b33a68601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7365443d1f60>)
  At least one of the input arguments for this task could not be computed:
ray.exceptions.RaySystemError: System error: invalid syntax (model.py, line 27)
traceback: Traceback (most recent call last):
  File "/root/src/fedSSL/client.py", line 18, in <module>
    from model import SimCLR, NTXentLoss, SimCLRPredictor
  File "/root/src/fedSSL/model.py", line 27
    self.batch_size = z_i.size(0).
                                  ^
SyntaxError: invalid syntax

debug | ERROR flwr 2024-06-28 01:22:12,740 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-28 01:22:25,783 | app.py:193 | Starting Flower simulation, config: num_rounds=5, no round_timeout
debug | INFO flwr 2024-06-28 01:22:27,705 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18802656460.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'node:__internal_head__': 1.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'memory': 37605312923.0}
debug | INFO flwr 2024-06-28 01:22:27,705 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-28 01:22:27,705 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-28 01:22:27,710 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-28 01:22:27,710 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-28 01:22:27,710 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-28 01:22:30,567 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-28 01:22:30,568 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-28 01:22:30,610 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': -1}
debug | INFO flwr 2024-06-28 01:22:30,610 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:22:30,610 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-28 01:22:30,610 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:23:20,628 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | WARNING flwr 2024-06-28 01:23:21,022 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 01:23:21,049 | server.py:129 | fit progress: (1, -1, {'accuracy': -1}, 50.43916499702027)
debug | INFO flwr 2024-06-28 01:23:21,050 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:24:09,301 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | WARNING flwr 2024-06-28 01:24:09,301 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 01:24:09,301 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:24:09,301 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-28 01:24:09,301 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:24:58,585 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:24:58,981 | server.py:129 | fit progress: (2, -1, {'accuracy': -1}, 148.37039361603092)
debug | INFO flwr 2024-06-28 01:24:58,981 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:25:47,258 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:25:47,258 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:25:47,258 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-28 01:25:47,258 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:26:36,590 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:26:37,007 | server.py:129 | fit progress: (3, -1, {'accuracy': -1}, 246.39624588401057)
debug | INFO flwr 2024-06-28 01:26:37,007 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:27:25,065 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:27:25,065 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:27:25,065 | server.py:111 | [ROUND 4]
debug | INFO flwr 2024-06-28 01:27:25,065 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:28:14,411 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:28:14,825 | server.py:129 | fit progress: (4, -1, {'accuracy': -1}, 344.21484692703234)
debug | INFO flwr 2024-06-28 01:28:14,825 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:29:03,087 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:29:03,087 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:29:03,087 | server.py:111 | [ROUND 5]
debug | INFO flwr 2024-06-28 01:29:03,087 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:29:52,447 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:30:24,265 | server.py:129 | fit progress: (5, tensor(0.9613, device='cuda:0'), {'accuracy': 0.6672}, 473.6551041750354)
debug | INFO flwr 2024-06-28 01:30:24,279 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:31:13,137 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:31:13,148 | server.py:494 | 
debug | INFO flwr 2024-06-28 01:31:13,148 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-28 01:31:13,148 | server.py:496 | Run finished 5 round(s) in 522.53s
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:498 | 		round 1: 6.151384496688843
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:498 | 		round 2: 5.919919776916504
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:498 | 		round 3: 5.8135058259963985
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:498 | 		round 4: 5.767803945541382
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:498 | 		round 5: 5.736773037910462
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:498 | 	History (loss, centralized):
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:498 | 		round 0: -1
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:498 | 		round 1: -1
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:498 | 		round 2: -1
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:498 | 		round 3: -1
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:498 | 		round 4: -1
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:498 | 		round 5: 0.9613267183303833
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:498 | 	History (metrics, centralized):
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:498 | 	{'accuracy': [(0, -1), (1, -1), (2, -1), (3, -1), (4, -1), (5, 0.6672)]}
debug | INFO flwr 2024-06-28 01:31:13,151 | server.py:499 | 
debug | INFO flwr 2024-06-28 01:40:45,392 | app.py:193 | Starting Flower simulation, config: num_rounds=5, no round_timeout
debug | INFO flwr 2024-06-28 01:40:47,316 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37945906791.0, 'object_store_memory': 18972953395.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0}
debug | INFO flwr 2024-06-28 01:40:47,316 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-28 01:40:47,316 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-28 01:40:47,321 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-28 01:40:47,321 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-28 01:40:47,321 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-28 01:40:50,127 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-28 01:40:50,127 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-28 01:40:50,171 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': -1}
debug | INFO flwr 2024-06-28 01:40:50,171 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:40:50,172 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-28 01:40:50,172 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:41:10,542 | app.py:193 | Starting Flower simulation, config: num_rounds=5, no round_timeout
debug | INFO flwr 2024-06-28 01:41:12,441 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 36066410496.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'node:__internal_head__': 1.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0, 'object_store_memory': 18033205248.0}
debug | INFO flwr 2024-06-28 01:41:12,441 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-28 01:41:12,441 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-28 01:41:12,446 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-28 01:41:12,446 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-28 01:41:12,446 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-28 01:41:15,291 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-28 01:41:15,291 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-28 01:41:15,335 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': -1}
debug | INFO flwr 2024-06-28 01:41:15,335 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:41:15,335 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-28 01:41:15,335 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:42:05,660 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | WARNING flwr 2024-06-28 01:42:06,061 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 01:42:06,092 | server.py:129 | fit progress: (1, -1, {'accuracy': -1}, 50.75681709300261)
debug | INFO flwr 2024-06-28 01:42:06,092 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:42:54,687 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | WARNING flwr 2024-06-28 01:42:54,687 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 01:42:54,688 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:42:54,688 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-28 01:42:54,688 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:43:44,166 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:43:44,592 | server.py:129 | fit progress: (2, -1, {'accuracy': -1}, 149.256232129992)
debug | INFO flwr 2024-06-28 01:43:44,592 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:44:32,876 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:44:32,877 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:44:32,877 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-28 01:44:32,877 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:45:22,799 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:45:23,224 | server.py:129 | fit progress: (3, -1, {'accuracy': -1}, 247.88900711300084)
debug | INFO flwr 2024-06-28 01:45:23,225 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:46:11,718 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:46:11,718 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:46:11,718 | server.py:111 | [ROUND 4]
debug | INFO flwr 2024-06-28 01:46:11,719 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:47:01,148 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:47:01,582 | server.py:129 | fit progress: (4, -1, {'accuracy': -1}, 346.24638998898445)
debug | INFO flwr 2024-06-28 01:47:01,582 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:47:50,207 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:47:50,207 | server.py:110 | 
debug | INFO flwr 2024-06-28 01:47:50,207 | server.py:111 | [ROUND 5]
debug | INFO flwr 2024-06-28 01:47:50,207 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:48:40,022 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:49:11,526 | server.py:129 | fit progress: (5, tensor(0.9804, device='cuda:0'), {'accuracy': 0.6569}, 476.19071744196117)
debug | INFO flwr 2024-06-28 01:49:11,543 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-06-28 01:49:59,914 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-06-28 01:49:59,923 | server.py:494 | 
debug | INFO flwr 2024-06-28 01:49:59,923 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-28 01:49:59,923 | server.py:496 | Run finished 5 round(s) in 524.58s
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:498 | 		round 1: 6.130284886360169
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:498 | 		round 2: 5.8964146757125855
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:498 | 		round 3: 5.80306830406189
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:498 | 		round 4: 5.7669912481307986
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:498 | 		round 5: 5.733444218635559
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:498 | 	History (loss, centralized):
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:498 | 		round 0: -1
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:498 | 		round 1: -1
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:498 | 		round 2: -1
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:498 | 		round 3: -1
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:498 | 		round 4: -1
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:498 | 		round 5: 0.9804369211196899
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:498 | 	History (metrics, centralized):
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:498 | 	{'accuracy': [(0, -1), (1, -1), (2, -1), (3, -1), (4, -1), (5, 0.6569)]}
debug | INFO flwr 2024-06-28 01:49:59,926 | server.py:499 | 
debug | INFO flwr 2024-06-28 11:53:44,401 | app.py:193 | Starting Flower simulation, config: num_rounds=1, no round_timeout
debug | INFO flwr 2024-06-28 11:53:46,271 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18971428454.0, 'node:__internal_head__': 1.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0, 'memory': 37942856910.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-28 11:53:46,272 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-28 11:53:46,272 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-28 11:53:46,277 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-28 11:53:46,277 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-28 11:53:46,277 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-28 11:53:49,123 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-28 11:53:49,123 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-28 11:53:49,167 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': -1}
debug | INFO flwr 2024-06-28 11:53:49,167 | server.py:110 | 
debug | INFO flwr 2024-06-28 11:53:49,167 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-28 11:53:49,167 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 11:54:37,312 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | WARNING flwr 2024-06-28 11:54:37,488 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 11:58:21,817 | server.py:129 | fit progress: (1, tensor(0.7191, device='cuda:0'), {'accuracy': 0.7512}, 272.65004121599486)
debug | INFO flwr 2024-06-28 11:58:21,830 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-28 11:58:41,167 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | WARNING flwr 2024-06-28 11:58:41,167 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 11:58:41,172 | server.py:494 | 
debug | INFO flwr 2024-06-28 11:58:41,172 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-28 11:58:41,172 | server.py:496 | Run finished 1 round(s) in 292.00s
debug | INFO flwr 2024-06-28 11:58:41,174 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-28 11:58:41,174 | server.py:498 | 		round 1: 5.920835554599762
debug | INFO flwr 2024-06-28 11:58:41,174 | server.py:498 | 	History (loss, centralized):
debug | INFO flwr 2024-06-28 11:58:41,174 | server.py:498 | 		round 0: -1
debug | INFO flwr 2024-06-28 11:58:41,174 | server.py:498 | 		round 1: 0.7191302180290222
debug | INFO flwr 2024-06-28 11:58:41,174 | server.py:498 | 	History (metrics, centralized):
debug | INFO flwr 2024-06-28 11:58:41,174 | server.py:498 | 	{'accuracy': [(0, -1), (1, 0.7512)]}
debug | INFO flwr 2024-06-28 11:58:41,174 | server.py:499 | 
debug | INFO flwr 2024-06-28 12:25:43,758 | app.py:193 | Starting Flower simulation, config: num_rounds=5, no round_timeout
debug | INFO flwr 2024-06-28 12:25:45,668 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:172.17.0.2': 1.0, 'CPU': 11.0, 'node:__internal_head__': 1.0, 'memory': 37935653684.0, 'object_store_memory': 18967826841.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-28 12:25:45,668 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-28 12:25:45,668 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-28 12:25:45,675 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-28 12:25:45,675 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-28 12:25:45,675 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-28 12:25:48,513 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-28 12:25:48,513 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-28 12:25:48,556 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': -1}
debug | INFO flwr 2024-06-28 12:25:48,556 | server.py:110 | 
debug | INFO flwr 2024-06-28 12:25:48,556 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-28 12:25:48,557 | server.py:224 | configure_fit: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:26:37,227 | server.py:238 | aggregate_fit: received 3 results and 0 failures
debug | WARNING flwr 2024-06-28 12:26:37,485 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 12:26:37,511 | server.py:129 | fit progress: (1, -1, {'accuracy': -1}, 48.954944727011025)
debug | INFO flwr 2024-06-28 12:26:37,512 | server.py:176 | configure_evaluate: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:27:06,727 | server.py:190 | aggregate_evaluate: received 3 results and 0 failures
debug | WARNING flwr 2024-06-28 12:27:06,727 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 12:27:06,727 | server.py:110 | 
debug | INFO flwr 2024-06-28 12:27:06,727 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-28 12:27:06,727 | server.py:224 | configure_fit: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:27:54,993 | server.py:238 | aggregate_fit: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:27:55,246 | server.py:129 | fit progress: (2, -1, {'accuracy': -1}, 126.68962407897925)
debug | INFO flwr 2024-06-28 12:27:55,246 | server.py:176 | configure_evaluate: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:28:24,287 | server.py:190 | aggregate_evaluate: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:28:24,287 | server.py:110 | 
debug | INFO flwr 2024-06-28 12:28:24,287 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-28 12:28:24,287 | server.py:224 | configure_fit: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:29:12,608 | server.py:238 | aggregate_fit: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:29:12,874 | server.py:129 | fit progress: (3, -1, {'accuracy': -1}, 204.3171763169812)
debug | INFO flwr 2024-06-28 12:29:12,874 | server.py:176 | configure_evaluate: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:29:41,807 | server.py:190 | aggregate_evaluate: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:29:41,807 | server.py:110 | 
debug | INFO flwr 2024-06-28 12:29:41,807 | server.py:111 | [ROUND 4]
debug | INFO flwr 2024-06-28 12:29:41,807 | server.py:224 | configure_fit: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:30:30,226 | server.py:238 | aggregate_fit: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:30:30,463 | server.py:129 | fit progress: (4, -1, {'accuracy': -1}, 281.9064890409936)
debug | INFO flwr 2024-06-28 12:30:30,463 | server.py:176 | configure_evaluate: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:30:59,381 | server.py:190 | aggregate_evaluate: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:30:59,381 | server.py:110 | 
debug | INFO flwr 2024-06-28 12:30:59,381 | server.py:111 | [ROUND 5]
debug | INFO flwr 2024-06-28 12:30:59,381 | server.py:224 | configure_fit: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:31:47,695 | server.py:238 | aggregate_fit: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:32:41,109 | server.py:129 | fit progress: (5, tensor(0.8655, device='cuda:0'), {'accuracy': 0.6992}, 412.55265287699876)
debug | INFO flwr 2024-06-28 12:32:41,122 | server.py:176 | configure_evaluate: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:33:10,097 | server.py:190 | aggregate_evaluate: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:33:10,102 | server.py:494 | 
debug | INFO flwr 2024-06-28 12:33:10,102 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-28 12:33:10,102 | server.py:496 | Run finished 5 round(s) in 441.54s
debug | INFO flwr 2024-06-28 12:33:10,109 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-28 12:33:10,109 | server.py:498 | 		round 1: 6.00465811882019
debug | INFO flwr 2024-06-28 12:33:10,109 | server.py:498 | 		round 2: 5.817761626309872
debug | INFO flwr 2024-06-28 12:33:10,109 | server.py:498 | 		round 3: 5.753389377695084
debug | INFO flwr 2024-06-28 12:33:10,109 | server.py:498 | 		round 4: 5.708507549525261
debug | INFO flwr 2024-06-28 12:33:10,110 | server.py:498 | 		round 5: 5.684856857922554
debug | INFO flwr 2024-06-28 12:33:10,110 | server.py:498 | 	History (loss, centralized):
debug | INFO flwr 2024-06-28 12:33:10,110 | server.py:498 | 		round 0: -1
debug | INFO flwr 2024-06-28 12:33:10,110 | server.py:498 | 		round 1: -1
debug | INFO flwr 2024-06-28 12:33:10,110 | server.py:498 | 		round 2: -1
debug | INFO flwr 2024-06-28 12:33:10,110 | server.py:498 | 		round 3: -1
debug | INFO flwr 2024-06-28 12:33:10,110 | server.py:498 | 		round 4: -1
debug | INFO flwr 2024-06-28 12:33:10,110 | server.py:498 | 		round 5: 0.8655062913894653
debug | INFO flwr 2024-06-28 12:33:10,110 | server.py:498 | 	History (metrics, centralized):
debug | INFO flwr 2024-06-28 12:33:10,110 | server.py:498 | 	{'accuracy': [(0, -1), (1, -1), (2, -1), (3, -1), (4, -1), (5, 0.6992)]}
debug | INFO flwr 2024-06-28 12:33:10,110 | server.py:499 | 
debug | INFO flwr 2024-06-28 12:49:16,298 | app.py:193 | Starting Flower simulation, config: num_rounds=7, no round_timeout
debug | INFO flwr 2024-06-28 12:49:18,202 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'memory': 37933518030.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'object_store_memory': 18966759014.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0}
debug | INFO flwr 2024-06-28 12:49:18,202 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-28 12:49:18,202 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-28 12:49:18,207 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-28 12:49:18,207 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-28 12:49:18,207 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-28 12:49:21,054 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-28 12:49:21,054 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-28 12:49:21,098 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': -1}
debug | INFO flwr 2024-06-28 12:49:21,099 | server.py:110 | 
debug | INFO flwr 2024-06-28 12:49:21,099 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-28 12:49:21,099 | server.py:224 | configure_fit: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:50:10,171 | server.py:238 | aggregate_fit: received 3 results and 0 failures
debug | WARNING flwr 2024-06-28 12:50:10,426 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 12:50:10,451 | server.py:129 | fit progress: (1, -1, {'accuracy': -1}, 49.35239801497664)
debug | INFO flwr 2024-06-28 12:50:10,451 | server.py:176 | configure_evaluate: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:50:39,483 | server.py:190 | aggregate_evaluate: received 3 results and 0 failures
debug | WARNING flwr 2024-06-28 12:50:39,484 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-28 12:50:39,484 | server.py:110 | 
debug | INFO flwr 2024-06-28 12:50:39,484 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-28 12:50:39,484 | server.py:224 | configure_fit: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:51:27,830 | server.py:238 | aggregate_fit: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:51:28,067 | server.py:129 | fit progress: (2, -1, {'accuracy': -1}, 126.96863457496511)
debug | INFO flwr 2024-06-28 12:51:28,067 | server.py:176 | configure_evaluate: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:51:57,015 | server.py:190 | aggregate_evaluate: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:51:57,015 | server.py:110 | 
debug | INFO flwr 2024-06-28 12:51:57,015 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-28 12:51:57,015 | server.py:224 | configure_fit: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:52:45,397 | server.py:238 | aggregate_fit: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:52:45,656 | server.py:129 | fit progress: (3, -1, {'accuracy': -1}, 204.5568976359791)
debug | INFO flwr 2024-06-28 12:52:45,656 | server.py:176 | configure_evaluate: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:53:14,685 | server.py:190 | aggregate_evaluate: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:53:14,685 | server.py:110 | 
debug | INFO flwr 2024-06-28 12:53:14,685 | server.py:111 | [ROUND 4]
debug | INFO flwr 2024-06-28 12:53:14,685 | server.py:224 | configure_fit: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:54:02,821 | server.py:238 | aggregate_fit: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:54:03,043 | server.py:129 | fit progress: (4, -1, {'accuracy': -1}, 281.9443988329731)
debug | INFO flwr 2024-06-28 12:54:03,043 | server.py:176 | configure_evaluate: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:54:31,802 | server.py:190 | aggregate_evaluate: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:54:31,802 | server.py:110 | 
debug | INFO flwr 2024-06-28 12:54:31,802 | server.py:111 | [ROUND 5]
debug | INFO flwr 2024-06-28 12:54:31,802 | server.py:224 | configure_fit: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:55:19,703 | server.py:238 | aggregate_fit: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:55:19,944 | server.py:129 | fit progress: (5, -1, {'accuracy': -1}, 358.8455051810015)
debug | INFO flwr 2024-06-28 12:55:19,944 | server.py:176 | configure_evaluate: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:55:48,810 | server.py:190 | aggregate_evaluate: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:55:48,810 | server.py:110 | 
debug | INFO flwr 2024-06-28 12:55:48,810 | server.py:111 | [ROUND 6]
debug | INFO flwr 2024-06-28 12:55:48,810 | server.py:224 | configure_fit: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:56:36,994 | server.py:238 | aggregate_fit: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:56:37,241 | server.py:129 | fit progress: (6, -1, {'accuracy': -1}, 436.14189915399766)
debug | INFO flwr 2024-06-28 12:56:37,241 | server.py:176 | configure_evaluate: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:57:06,148 | server.py:190 | aggregate_evaluate: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:57:06,148 | server.py:110 | 
debug | INFO flwr 2024-06-28 12:57:06,148 | server.py:111 | [ROUND 7]
debug | INFO flwr 2024-06-28 12:57:06,148 | server.py:224 | configure_fit: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 12:57:53,730 | server.py:238 | aggregate_fit: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 12:59:33,061 | server.py:129 | fit progress: (7, tensor(0.7790, device='cuda:0'), {'accuracy': 0.7288}, 611.9624331619707)
debug | INFO flwr 2024-06-28 12:59:33,074 | server.py:176 | configure_evaluate: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-06-28 13:00:02,115 | server.py:190 | aggregate_evaluate: received 3 results and 0 failures
debug | INFO flwr 2024-06-28 13:00:02,121 | server.py:494 | 
debug | INFO flwr 2024-06-28 13:00:02,121 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-28 13:00:02,121 | server.py:496 | Run finished 7 round(s) in 641.02s
debug | INFO flwr 2024-06-28 13:00:02,123 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-28 13:00:02,123 | server.py:498 | 		round 1: 5.9867886841850275
debug | INFO flwr 2024-06-28 13:00:02,123 | server.py:498 | 		round 2: 5.812519835021973
debug | INFO flwr 2024-06-28 13:00:02,123 | server.py:498 | 		round 3: 5.762028874903202
debug | INFO flwr 2024-06-28 13:00:02,123 | server.py:498 | 		round 4: 5.7205913995542526
debug | INFO flwr 2024-06-28 13:00:02,123 | server.py:498 | 		round 5: 5.679712795522691
debug | INFO flwr 2024-06-28 13:00:02,123 | server.py:498 | 		round 6: 5.664760360446929
debug | INFO flwr 2024-06-28 13:00:02,123 | server.py:498 | 		round 7: 5.653789782679557
debug | INFO flwr 2024-06-28 13:00:02,123 | server.py:498 | 	History (loss, centralized):
debug | INFO flwr 2024-06-28 13:00:02,123 | server.py:498 | 		round 0: -1
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 		round 1: -1
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 		round 2: -1
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 		round 3: -1
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 		round 4: -1
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 		round 5: -1
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 		round 6: -1
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 		round 7: 0.7790366411209106
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 	History (metrics, centralized):
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 	{'accuracy': [(0, -1),
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 	              (1, -1),
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 	              (2, -1),
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 	              (3, -1),
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 	              (4, -1),
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 	              (5, -1),
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 	              (6, -1),
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:498 | 	              (7, 0.7288)]}
debug | INFO flwr 2024-06-28 13:00:02,124 | server.py:499 | 
debug | INFO flwr 2024-07-07 03:51:26,321 | app.py:193 | Starting Flower simulation, config: num_rounds=7, no round_timeout
debug | INFO flwr 2024-07-07 03:51:28,298 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37612501403.0, 'object_store_memory': 18806250700.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0}
debug | INFO flwr 2024-07-07 03:51:28,298 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-07-07 03:51:28,298 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 8.0}
debug | WARNING flwr 2024-07-07 03:51:28,299 | ray_actor.py:124 | The ActorPool is empty. The system (CPUs=11.0, GPUs=1.0) does not meet the criteria to host at least one client with resources: {'num_cpus': 1, 'num_gpus': 8.0}. Lowering the `client_resources` could help.
debug | INFO flwr 2024-07-07 03:52:49,972 | app.py:193 | Starting Flower simulation, config: num_rounds=7, no round_timeout
debug | INFO flwr 2024-07-07 03:52:51,907 | app.py:228 | Flower VCE: Ray initialized with resources: {'CPU': 11.0, 'node:172.17.0.2': 1.0, 'node:__internal_head__': 1.0, 'object_store_memory': 18806304768.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'memory': 37612609536.0}
debug | INFO flwr 2024-07-07 03:52:51,908 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-07-07 03:52:51,908 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 1.0}
debug | INFO flwr 2024-07-07 03:52:51,913 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-07-07 03:52:51,913 | server.py:92 | [INIT]
debug | INFO flwr 2024-07-07 03:52:51,913 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-07-07 03:52:54,766 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-07-07 03:52:54,766 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-07-07 03:52:54,810 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': -1}
debug | INFO flwr 2024-07-07 03:52:54,810 | server.py:110 | 
debug | INFO flwr 2024-07-07 03:52:54,810 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-07-07 03:52:54,810 | server.py:224 | configure_fit: strategy sampled 3 clients (out of 3)
debug | INFO flwr 2024-07-07 04:05:59,914 | app.py:193 | Starting Flower simulation, config: num_rounds=7, no round_timeout
debug | INFO flwr 2024-07-07 04:06:01,858 | app.py:228 | Flower VCE: Ray initialized with resources: {'GPU': 1.0, 'accelerator_type:G': 1.0, 'memory': 37644609947.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'node:__internal_head__': 1.0, 'object_store_memory': 18822304972.0}
debug | INFO flwr 2024-07-07 04:06:01,858 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-07-07 04:06:01,858 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 2.0}
debug | WARNING flwr 2024-07-07 04:06:01,859 | ray_actor.py:124 | The ActorPool is empty. The system (CPUs=11.0, GPUs=1.0) does not meet the criteria to host at least one client with resources: {'num_cpus': 1, 'num_gpus': 2.0}. Lowering the `client_resources` could help.
debug | INFO flwr 2024-07-08 03:10:01,199 | app.py:193 | Starting Flower simulation, config: num_rounds=7, no round_timeout
debug | INFO flwr 2024-07-08 03:10:03,127 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'object_store_memory': 18990511718.0, 'memory': 37981023438.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0, 'accelerator_type:G': 1.0, 'GPU': 1.0}
debug | INFO flwr 2024-07-08 03:10:03,127 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-07-08 03:10:03,127 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 1.0}
debug | INFO flwr 2024-07-08 03:10:03,133 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-07-08 03:10:03,133 | server.py:92 | [INIT]
debug | INFO flwr 2024-07-08 03:10:03,133 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-07-08 03:10:06,570 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-07-08 03:10:06,570 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-07-08 03:10:06,614 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': -1}
debug | INFO flwr 2024-07-08 03:10:06,614 | server.py:110 | 
debug | INFO flwr 2024-07-08 03:10:06,614 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-07-08 03:10:06,614 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:10:56,824 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | WARNING flwr 2024-07-08 03:10:57,229 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-07-08 03:10:57,254 | server.py:129 | fit progress: (1, -1, {'accuracy': -1}, 50.64032180904178)
debug | INFO flwr 2024-07-08 03:10:57,254 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:11:46,105 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | WARNING flwr 2024-07-08 03:11:46,105 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-07-08 03:11:46,105 | server.py:110 | 
debug | INFO flwr 2024-07-08 03:11:46,105 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-07-08 03:11:46,105 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:12:35,609 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:12:36,000 | server.py:129 | fit progress: (2, -1, {'accuracy': -1}, 149.38625875103753)
debug | INFO flwr 2024-07-08 03:12:36,000 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:13:24,390 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:13:24,390 | server.py:110 | 
debug | INFO flwr 2024-07-08 03:13:24,390 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-07-08 03:13:24,390 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:14:14,262 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:14:14,678 | server.py:129 | fit progress: (3, -1, {'accuracy': -1}, 248.0646232260042)
debug | INFO flwr 2024-07-08 03:14:14,679 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:15:03,058 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:15:03,058 | server.py:110 | 
debug | INFO flwr 2024-07-08 03:15:03,058 | server.py:111 | [ROUND 4]
debug | INFO flwr 2024-07-08 03:15:03,058 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:15:52,968 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:15:53,371 | server.py:129 | fit progress: (4, -1, {'accuracy': -1}, 346.7572929360322)
debug | INFO flwr 2024-07-08 03:15:53,371 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:16:41,655 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:16:41,655 | server.py:110 | 
debug | INFO flwr 2024-07-08 03:16:41,655 | server.py:111 | [ROUND 5]
debug | INFO flwr 2024-07-08 03:16:41,655 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:17:31,218 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:17:31,637 | server.py:129 | fit progress: (5, -1, {'accuracy': -1}, 445.0235903580324)
debug | INFO flwr 2024-07-08 03:17:31,637 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:18:19,666 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:18:19,666 | server.py:110 | 
debug | INFO flwr 2024-07-08 03:18:19,666 | server.py:111 | [ROUND 6]
debug | INFO flwr 2024-07-08 03:18:19,666 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:19:08,856 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:19:09,276 | server.py:129 | fit progress: (6, -1, {'accuracy': -1}, 542.6624616199988)
debug | INFO flwr 2024-07-08 03:19:09,276 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:19:57,250 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:19:57,250 | server.py:110 | 
debug | INFO flwr 2024-07-08 03:19:57,250 | server.py:111 | [ROUND 7]
debug | INFO flwr 2024-07-08 03:19:57,250 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:20:46,391 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:22:26,497 | server.py:129 | fit progress: (7, tensor(2.1456, device='cuda:0'), {'accuracy': 0.4349}, 739.8833090880071)
debug | INFO flwr 2024-07-08 03:22:26,530 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:23:15,457 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:23:15,466 | server.py:494 | 
debug | INFO flwr 2024-07-08 03:23:15,466 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-07-08 03:23:15,466 | server.py:496 | Run finished 7 round(s) in 788.84s
debug | INFO flwr 2024-07-08 03:23:15,469 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-07-08 03:23:15,469 | server.py:498 | 		round 1: 6.085066938400269
debug | INFO flwr 2024-07-08 03:23:15,469 | server.py:498 | 		round 2: 5.865628323554993
debug | INFO flwr 2024-07-08 03:23:15,469 | server.py:498 | 		round 3: 5.789998960494995
debug | INFO flwr 2024-07-08 03:23:15,469 | server.py:498 | 		round 4: 5.7415280389785766
debug | INFO flwr 2024-07-08 03:23:15,469 | server.py:498 | 		round 5: 5.718698573112488
debug | INFO flwr 2024-07-08 03:23:15,469 | server.py:498 | 		round 6: 5.693498234748841
debug | INFO flwr 2024-07-08 03:23:15,469 | server.py:498 | 		round 7: 5.684086699485778
debug | INFO flwr 2024-07-08 03:23:15,469 | server.py:498 | 	History (loss, centralized):
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 		round 0: -1
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 		round 1: -1
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 		round 2: -1
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 		round 3: -1
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 		round 4: -1
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 		round 5: -1
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 		round 6: -1
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 		round 7: 2.1455814838409424
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 	History (metrics, centralized):
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 	{'accuracy': [(0, -1),
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 	              (1, -1),
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 	              (2, -1),
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 	              (3, -1),
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 	              (4, -1),
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 	              (5, -1),
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 	              (6, -1),
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:498 | 	              (7, 0.4349)]}
debug | INFO flwr 2024-07-08 03:23:15,470 | server.py:499 | 
debug | INFO flwr 2024-07-08 03:26:35,930 | app.py:193 | Starting Flower simulation, config: num_rounds=7, no round_timeout
debug | INFO flwr 2024-07-08 03:26:37,807 | app.py:228 | Flower VCE: Ray initialized with resources: {'CPU': 11.0, 'node:172.17.0.2': 1.0, 'node:__internal_head__': 1.0, 'memory': 37978219316.0, 'object_store_memory': 18989109657.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-07-08 03:26:37,807 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-07-08 03:26:37,807 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 1.0}
debug | INFO flwr 2024-07-08 03:26:37,816 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-07-08 03:26:37,816 | server.py:92 | [INIT]
debug | INFO flwr 2024-07-08 03:26:37,816 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-07-08 03:26:41,228 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-07-08 03:26:41,228 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-07-08 03:28:20,490 | server.py:97 | initial parameters (loss, other metrics): tensor(2.2124, device='cuda:0'), {'accuracy': 0.43}
debug | INFO flwr 2024-07-08 03:28:20,507 | server.py:110 | 
debug | INFO flwr 2024-07-08 03:28:20,507 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-07-08 03:28:20,507 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:29:10,555 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | WARNING flwr 2024-07-08 03:29:10,975 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-07-08 03:30:50,746 | server.py:129 | fit progress: (1, tensor(2.1291, device='cuda:0'), {'accuracy': 0.4496}, 150.23933026799932)
debug | INFO flwr 2024-07-08 03:30:50,747 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:31:39,182 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | WARNING flwr 2024-07-08 03:31:39,182 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-07-08 03:31:39,182 | server.py:110 | 
debug | INFO flwr 2024-07-08 03:31:39,182 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-07-08 03:31:39,183 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:32:28,854 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:34:08,361 | server.py:129 | fit progress: (2, tensor(2.0731, device='cuda:0'), {'accuracy': 0.4546}, 347.85433201899286)
debug | INFO flwr 2024-07-08 03:34:08,362 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:34:56,392 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:34:56,392 | server.py:110 | 
debug | INFO flwr 2024-07-08 03:34:56,392 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-07-08 03:34:56,392 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:35:46,291 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:37:25,694 | server.py:129 | fit progress: (3, tensor(2.1658, device='cuda:0'), {'accuracy': 0.4409}, 545.1872980130138)
debug | INFO flwr 2024-07-08 03:37:25,695 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:38:14,301 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:38:14,301 | server.py:110 | 
debug | INFO flwr 2024-07-08 03:38:14,301 | server.py:111 | [ROUND 4]
debug | INFO flwr 2024-07-08 03:38:14,301 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:39:04,243 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:40:44,109 | server.py:129 | fit progress: (4, tensor(2.1084, device='cuda:0'), {'accuracy': 0.4497}, 743.6013788389973)
debug | INFO flwr 2024-07-08 03:40:44,109 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:41:33,060 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:41:33,061 | server.py:110 | 
debug | INFO flwr 2024-07-08 03:41:33,061 | server.py:111 | [ROUND 5]
debug | INFO flwr 2024-07-08 03:41:33,061 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:42:22,839 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:44:04,021 | server.py:129 | fit progress: (5, tensor(2.0726, device='cuda:0'), {'accuracy': 0.4552}, 943.5137658159947)
debug | INFO flwr 2024-07-08 03:44:04,022 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:44:52,431 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:44:52,432 | server.py:110 | 
debug | INFO flwr 2024-07-08 03:44:52,432 | server.py:111 | [ROUND 6]
debug | INFO flwr 2024-07-08 03:44:52,432 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:45:41,972 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:47:22,906 | server.py:129 | fit progress: (6, tensor(2.0092, device='cuda:0'), {'accuracy': 0.4675}, 1142.3990317470161)
debug | INFO flwr 2024-07-08 03:47:22,907 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:48:11,107 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:48:11,107 | server.py:110 | 
debug | INFO flwr 2024-07-08 03:48:11,107 | server.py:111 | [ROUND 7]
debug | INFO flwr 2024-07-08 03:48:11,107 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:49:00,586 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:50:42,030 | server.py:129 | fit progress: (7, tensor(1.9583, device='cuda:0'), {'accuracy': 0.4808}, 1341.522772072989)
debug | INFO flwr 2024-07-08 03:50:42,031 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 03:51:30,020 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 03:51:30,030 | server.py:494 | 
debug | INFO flwr 2024-07-08 03:51:30,030 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-07-08 03:51:30,030 | server.py:496 | Run finished 7 round(s) in 1389.51s
debug | INFO flwr 2024-07-08 03:51:30,032 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-07-08 03:51:30,032 | server.py:498 | 		round 1: 6.095353627204895
debug | INFO flwr 2024-07-08 03:51:30,032 | server.py:498 | 		round 2: 5.864863820075989
debug | INFO flwr 2024-07-08 03:51:30,032 | server.py:498 | 		round 3: 5.791240496635437
debug | INFO flwr 2024-07-08 03:51:30,032 | server.py:498 | 		round 4: 5.748544726371765
debug | INFO flwr 2024-07-08 03:51:30,032 | server.py:498 | 		round 5: 5.720109295845032
debug | INFO flwr 2024-07-08 03:51:30,032 | server.py:498 | 		round 6: 5.707956976890564
debug | INFO flwr 2024-07-08 03:51:30,032 | server.py:498 | 		round 7: 5.6813270854949955
debug | INFO flwr 2024-07-08 03:51:30,032 | server.py:498 | 	History (loss, centralized):
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 		round 0: 2.2124133110046387
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 		round 1: 2.1290576457977295
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 		round 2: 2.0731327533721924
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 		round 3: 2.16582989692688
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 		round 4: 2.108377456665039
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 		round 5: 2.0725629329681396
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 		round 6: 2.009193181991577
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 		round 7: 1.9583200216293335
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 	History (metrics, centralized):
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 	{'accuracy': [(0, 0.43),
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 	              (1, 0.4496),
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 	              (2, 0.4546),
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 	              (3, 0.4409),
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 	              (4, 0.4497),
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 	              (5, 0.4552),
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 	              (6, 0.4675),
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:498 | 	              (7, 0.4808)]}
debug | INFO flwr 2024-07-08 03:51:30,033 | server.py:499 | 
debug | INFO flwr 2024-07-08 04:49:16,655 | app.py:193 | Starting Flower simulation, config: num_rounds=7, no round_timeout
debug | INFO flwr 2024-07-08 04:49:18,553 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'object_store_memory': 18987139891.0, 'memory': 37974279783.0}
debug | INFO flwr 2024-07-08 04:49:18,553 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-07-08 04:49:18,553 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 1, 'num_gpus': 1.0}
debug | INFO flwr 2024-07-08 04:49:18,558 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-07-08 04:49:18,558 | server.py:92 | [INIT]
debug | INFO flwr 2024-07-08 04:49:18,558 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-07-08 04:49:21,889 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-07-08 04:49:21,889 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-07-08 04:49:21,935 | server.py:97 | initial parameters (loss, other metrics): -1, {'accuracy': -1}
debug | INFO flwr 2024-07-08 04:49:21,935 | server.py:110 | 
debug | INFO flwr 2024-07-08 04:49:21,935 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-07-08 04:49:21,935 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 04:50:12,258 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | WARNING flwr 2024-07-08 04:50:12,655 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-07-08 04:50:12,682 | server.py:129 | fit progress: (1, -1, {'accuracy': -1}, 50.74772182601737)
debug | INFO flwr 2024-07-08 04:50:12,683 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 04:51:01,074 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | WARNING flwr 2024-07-08 04:51:01,074 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-07-08 04:51:01,074 | server.py:110 | 
debug | INFO flwr 2024-07-08 04:51:01,074 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-07-08 04:51:01,074 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 04:51:50,767 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 04:51:51,183 | server.py:129 | fit progress: (2, -1, {'accuracy': -1}, 149.24880505999317)
debug | INFO flwr 2024-07-08 04:51:51,184 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 04:52:39,213 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 04:52:39,213 | server.py:110 | 
debug | INFO flwr 2024-07-08 04:52:39,213 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-07-08 04:52:39,213 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 04:53:28,613 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 04:53:29,042 | server.py:129 | fit progress: (3, -1, {'accuracy': -1}, 247.1070443969802)
debug | INFO flwr 2024-07-08 04:53:29,042 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 04:54:17,397 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 04:54:17,397 | server.py:110 | 
debug | INFO flwr 2024-07-08 04:54:17,397 | server.py:111 | [ROUND 4]
debug | INFO flwr 2024-07-08 04:54:17,397 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 04:55:07,197 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 04:55:07,616 | server.py:129 | fit progress: (4, -1, {'accuracy': -1}, 345.68094174400903)
debug | INFO flwr 2024-07-08 04:55:07,616 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 04:55:56,061 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 04:55:56,061 | server.py:110 | 
debug | INFO flwr 2024-07-08 04:55:56,061 | server.py:111 | [ROUND 5]
debug | INFO flwr 2024-07-08 04:55:56,061 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 04:56:45,740 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 04:56:46,163 | server.py:129 | fit progress: (5, -1, {'accuracy': -1}, 444.22817545197904)
debug | INFO flwr 2024-07-08 04:56:46,163 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 04:57:34,457 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 04:57:34,457 | server.py:110 | 
debug | INFO flwr 2024-07-08 04:57:34,457 | server.py:111 | [ROUND 6]
debug | INFO flwr 2024-07-08 04:57:34,457 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 04:58:24,018 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 04:58:24,418 | server.py:129 | fit progress: (6, -1, {'accuracy': -1}, 542.4838260919787)
debug | INFO flwr 2024-07-08 04:58:24,419 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 04:59:12,715 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 04:59:12,715 | server.py:110 | 
debug | INFO flwr 2024-07-08 04:59:12,715 | server.py:111 | [ROUND 7]
debug | INFO flwr 2024-07-08 04:59:12,715 | server.py:224 | configure_fit: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 05:00:02,545 | server.py:238 | aggregate_fit: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 05:01:43,396 | server.py:129 | fit progress: (7, tensor(0.8421, device='cuda:0'), {'accuracy': 0.7117}, 741.461313398031)
debug | INFO flwr 2024-07-08 05:01:43,410 | server.py:176 | configure_evaluate: strategy sampled 5 clients (out of 5)
debug | INFO flwr 2024-07-08 05:02:31,561 | server.py:190 | aggregate_evaluate: received 5 results and 0 failures
debug | INFO flwr 2024-07-08 05:02:31,571 | server.py:494 | 
debug | INFO flwr 2024-07-08 05:02:31,571 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-07-08 05:02:31,571 | server.py:496 | Run finished 7 round(s) in 789.63s
debug | INFO flwr 2024-07-08 05:02:31,577 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-07-08 05:02:31,577 | server.py:498 | 		round 1: 6.127738461494446
debug | INFO flwr 2024-07-08 05:02:31,577 | server.py:498 | 		round 2: 5.907658085823059
debug | INFO flwr 2024-07-08 05:02:31,577 | server.py:498 | 		round 3: 5.817014331817627
debug | INFO flwr 2024-07-08 05:02:31,577 | server.py:498 | 		round 4: 5.770751643180847
debug | INFO flwr 2024-07-08 05:02:31,577 | server.py:498 | 		round 5: 5.733781762123108
debug | INFO flwr 2024-07-08 05:02:31,577 | server.py:498 | 		round 6: 5.709920072555542
debug | INFO flwr 2024-07-08 05:02:31,577 | server.py:498 | 		round 7: 5.682531967163086
debug | INFO flwr 2024-07-08 05:02:31,577 | server.py:498 | 	History (loss, centralized):
debug | INFO flwr 2024-07-08 05:02:31,577 | server.py:498 | 		round 0: -1
debug | INFO flwr 2024-07-08 05:02:31,577 | server.py:498 | 		round 1: -1
debug | INFO flwr 2024-07-08 05:02:31,577 | server.py:498 | 		round 2: -1
debug | INFO flwr 2024-07-08 05:02:31,578 | server.py:498 | 		round 3: -1
debug | INFO flwr 2024-07-08 05:02:31,578 | server.py:498 | 		round 4: -1
debug | INFO flwr 2024-07-08 05:02:31,578 | server.py:498 | 		round 5: -1
debug | INFO flwr 2024-07-08 05:02:31,578 | server.py:498 | 		round 6: -1
debug | INFO flwr 2024-07-08 05:02:31,578 | server.py:498 | 		round 7: 0.8420501947402954
debug | INFO flwr 2024-07-08 05:02:31,578 | server.py:498 | 	History (metrics, centralized):
debug | INFO flwr 2024-07-08 05:02:31,578 | server.py:498 | 	{'accuracy': [(0, -1),
debug | INFO flwr 2024-07-08 05:02:31,578 | server.py:498 | 	              (1, -1),
debug | INFO flwr 2024-07-08 05:02:31,578 | server.py:498 | 	              (2, -1),
debug | INFO flwr 2024-07-08 05:02:31,578 | server.py:498 | 	              (3, -1),
debug | INFO flwr 2024-07-08 05:02:31,578 | server.py:498 | 	              (4, -1),
debug | INFO flwr 2024-07-08 05:02:31,578 | server.py:498 | 	              (5, -1),
debug | INFO flwr 2024-07-08 05:02:31,578 | server.py:498 | 	              (6, -1),
debug | INFO flwr 2024-07-08 05:02:31,578 | server.py:498 | 	              (7, 0.7117)]}
debug | INFO flwr 2024-07-08 05:02:31,578 | server.py:499 | 
