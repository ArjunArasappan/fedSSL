debug | INFO flwr 2024-06-26 17:22:09,434 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 17:22:11,348 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37916059239.0, 'node:__internal_head__': 1.0, 'object_store_memory': 18958029619.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-26 17:22:11,348 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 17:22:11,348 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 17:22:11,353 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 17:22:11,353 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 17:22:11,353 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 17:22:13,976 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 17:22:13,977 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 17:22:13,977 | server.py:110 | 
debug | INFO flwr 2024-06-26 17:22:13,977 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 17:22:13,977 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 17:22:14,915 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:14,915 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:15,659 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:15,659 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:16,383 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:16,383 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:17,108 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:17,108 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:17,840 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:17,841 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:18,566 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:18,567 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:19,287 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:19,288 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:20,015 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:20,015 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:20,742 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:20,743 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:21,421 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:21,421 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | INFO flwr 2024-06-26 17:22:21,422 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 17:22:21,422 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 17:22:22,192 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:22,192 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:22,890 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:22,891 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:23,572 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:23,572 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:24,255 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:24,256 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:24,940 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:24,940 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:25,628 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:25,628 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:26,323 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:26,323 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:27,042 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:27,042 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:27,747 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:27,747 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | ERROR flwr 2024-06-26 17:22:28,401 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU

debug | ERROR flwr 2024-06-26 17:22:28,401 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 42, in forward
    sim = self.similarity_f(z.unsqueeze(1), z.unsqueeze(0)) / self.temperature
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/distance.py", line 89, in forward
    return F.cosine_similarity(x1, x2, self.dim, self.eps)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 8.00 GiB. GPU 

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=168953, ip=172.17.0.2, actor_id=f6fc7b8407f93260f8970a6a01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x773dcc2cdf60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CUDA out of memory. Tried to allocate 8.00 GiB. GPU
debug | INFO flwr 2024-06-26 17:47:15,620 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 17:47:17,507 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0, 'memory': 37916730164.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'object_store_memory': 18958365081.0}
debug | INFO flwr 2024-06-26 17:47:17,507 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 17:47:17,507 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 17:47:17,512 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 17:47:17,513 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 17:47:17,513 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 17:47:20,129 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 17:47:20,129 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 17:47:20,129 | server.py:110 | 
debug | INFO flwr 2024-06-26 17:47:20,129 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 17:47:20,129 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 17:47:21,031 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:21,032 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:21,745 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:21,745 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:22,433 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:22,433 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:23,128 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:23,128 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:23,831 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:23,831 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:24,510 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:24,510 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:25,189 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:25,189 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:25,873 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:25,873 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:26,558 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:26,558 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-26 17:47:27,203 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-26 17:47:27,203 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 68, in forward
    print(z_i.shape())
TypeError: 'torch.Size' object is not callable

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=174647, ip=172.17.0.2, actor_id=b16ba9d1c6c76cab5955d9e801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7d18f46c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'torch.Size' object is not callable
debug | INFO flwr 2024-06-26 17:47:33,258 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 17:47:35,164 | app.py:228 | Flower VCE: Ray initialized with resources: {'GPU': 1.0, 'accelerator_type:G': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'object_store_memory': 18957894451.0, 'node:__internal_head__': 1.0, 'memory': 37915788903.0}
debug | INFO flwr 2024-06-26 17:47:35,164 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 17:47:35,164 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 17:47:35,169 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 17:47:35,169 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 17:47:35,170 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 17:47:37,742 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 17:47:37,742 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 17:47:37,742 | server.py:110 | 
debug | INFO flwr 2024-06-26 17:47:37,742 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 17:47:37,742 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | INFO flwr 2024-06-26 17:52:45,121 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 17:52:47,014 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'memory': 37916356608.0, 'object_store_memory': 18958178304.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0}
debug | INFO flwr 2024-06-26 17:52:47,014 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 17:52:47,014 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 17:52:47,019 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 17:52:47,019 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 17:52:47,019 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 17:52:49,612 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 17:52:49,612 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 17:52:49,612 | server.py:110 | 
debug | INFO flwr 2024-06-26 17:52:49,612 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 17:52:49,612 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | INFO flwr 2024-06-26 17:53:38,334 | server.py:238 | aggregate_fit: received 10 results and 0 failures
debug | WARNING flwr 2024-06-26 17:53:38,751 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-26 17:53:38,752 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | INFO flwr 2024-06-26 18:20:03,857 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:20:05,753 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18957782630.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0, 'memory': 37915565262.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-26 18:20:05,753 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:20:05,753 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:20:05,758 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:20:05,758 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:20:05,758 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:20:08,362 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:20:08,362 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:20:08,362 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:20:08,362 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:20:08,362 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | INFO flwr 2024-06-26 18:20:57,749 | server.py:238 | aggregate_fit: received 10 results and 0 failures
debug | WARNING flwr 2024-06-26 18:20:58,148 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-26 18:20:58,149 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | INFO flwr 2024-06-26 18:28:24,587 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:28:26,497 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'object_store_memory': 18957180518.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'memory': 37914361038.0}
debug | INFO flwr 2024-06-26 18:28:26,498 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:28:26,498 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:28:26,502 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:28:26,503 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:28:26,503 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:28:29,112 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:28:29,112 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:28:29,112 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:28:29,112 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:28:29,113 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:28:30,033 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:30,033 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:30,729 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:30,729 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:31,435 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:31,435 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:32,162 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:32,162 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:32,910 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:32,911 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:33,608 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:33,608 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:34,316 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:34,316 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:35,057 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:35,057 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:35,765 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:35,765 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:36,442 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:36,442 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | INFO flwr 2024-06-26 18:28:36,443 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:28:36,443 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:28:37,199 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:37,199 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:37,873 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:37,873 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:38,540 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:38,541 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:39,211 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:39,211 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:39,879 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:39,880 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:40,554 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:40,554 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:41,219 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:41,220 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:41,891 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:41,891 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:42,582 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:42,582 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:43,217 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:43,218 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | INFO flwr 2024-06-26 18:28:43,218 | server.py:190 | aggregate_evaluate: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:28:43,218 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:28:43,218 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-26 18:28:43,218 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:28:43,997 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:43,997 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:44,712 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:44,712 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:45,415 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:45,415 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:46,116 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:46,116 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:46,810 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:46,810 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones()
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:47,528 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:47,528 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:48,236 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:48,236 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | ERROR flwr 2024-06-26 18:28:48,943 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor

debug | ERROR flwr 2024-06-26 18:28:48,944 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
TypeError: can't assign a builtin_function_or_method to a torch.FloatTensor

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=187706, ip=172.17.0.2, actor_id=d15243a43d62b3a2a446155e01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7304680c9f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: can't assign a builtin_function_or_method to a torch.FloatTensor
debug | INFO flwr 2024-06-26 18:28:54,667 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:28:56,582 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37912970036.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'object_store_memory': 18956485017.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0}
debug | INFO flwr 2024-06-26 18:28:56,582 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:28:56,582 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:28:56,587 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:28:56,587 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:28:56,587 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:28:59,183 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:28:59,183 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:28:59,183 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:28:59,183 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:28:59,183 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:29:00,128 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:00,128 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:00,833 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:00,833 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:01,540 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:01,540 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:02,245 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:02,245 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:02,975 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:02,976 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:03,689 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:03,689 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:04,402 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:04,403 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:05,113 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:05,113 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:05,841 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:05,841 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:06,507 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:06,507 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | INFO flwr 2024-06-26 18:29:06,507 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:29:06,507 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:29:07,284 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:07,284 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:07,989 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:07,989 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:08,672 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:08,672 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:09,346 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:09,346 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:10,028 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:10,028 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:10,699 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:10,699 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:11,385 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:11,385 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:12,086 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:12,086 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:12,802 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:12,802 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | ERROR flwr 2024-06-26 18:29:13,466 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

debug | ERROR flwr 2024-06-26 18:29:13,467 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 120, in forward
    labels[:, batch_size] = torch.ones(batch_size * 2)
RuntimeError: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=188818, ip=172.17.0.2, actor_id=087d322369118c86e1e484c601000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7632b81d1f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: The expanded size of the tensor (1024) must match the existing size (512) at non-singleton dimension 0.  Target sizes: [1024].  Tensor sizes: [512]
debug | INFO flwr 2024-06-26 18:29:22,693 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:29:24,586 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:172.17.0.2': 1.0, 'CPU': 11.0, 'memory': 37911991911.0, 'node:__internal_head__': 1.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'object_store_memory': 18955995955.0}
debug | INFO flwr 2024-06-26 18:29:24,586 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:29:24,586 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:29:24,591 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:29:24,592 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:29:24,592 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:29:27,190 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:29:27,190 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:29:27,190 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:29:27,190 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:29:27,190 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:29:28,130 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:28,131 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:28,839 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:28,839 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:29,547 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:29,547 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:30,266 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:30,267 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:30,978 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:30,978 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:31,704 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:31,704 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:32,404 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:32,404 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:33,128 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:33,128 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:33,838 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:33,838 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:34,514 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:34,514 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | INFO flwr 2024-06-26 18:29:34,514 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:29:34,514 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:29:35,271 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:35,271 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:35,982 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:35,982 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:36,646 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:36,646 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:37,313 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:37,313 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(logits, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:37,990 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:37,991 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:38,675 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:38,675 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:39,356 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:39,356 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:40,024 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:40,024 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:40,720 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:40,720 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | ERROR flwr 2024-06-26 18:29:41,383 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined

debug | ERROR flwr 2024-06-26 18:29:41,383 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
NameError: name 'logits' is not defined

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=189959, ip=172.17.0.2, actor_id=0b42ff543a2b0703815f92ab01000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7967447c1f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: name 'logits' is not defined
debug | INFO flwr 2024-06-26 18:29:51,105 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:29:52,982 | app.py:228 | Flower VCE: Ray initialized with resources: {'GPU': 1.0, 'accelerator_type:G': 1.0, 'object_store_memory': 18956427264.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'node:__internal_head__': 1.0, 'memory': 37912854528.0}
debug | INFO flwr 2024-06-26 18:29:52,983 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:29:52,983 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:29:52,988 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:29:52,988 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:29:52,988 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:29:55,614 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:29:55,614 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:29:55,614 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:29:55,614 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:29:55,614 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:29:56,553 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:29:56,554 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:29:57,278 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:29:57,278 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:29:58,003 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:29:58,003 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:29:58,715 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:29:58,715 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:29:59,419 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:29:59,419 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:30:00,111 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:30:00,111 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:30:00,813 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:30:00,813 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:30:01,496 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:30:01,497 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:30:02,200 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:30:02,200 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | ERROR flwr 2024-06-26 18:30:02,858 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

debug | ERROR flwr 2024-06-26 18:30:02,858 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels, ignore_index = 0)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=191090, ip=172.17.0.2, actor_id=d0be120d1cc6cee271e0d00101000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e80543d1ea0>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: CrossEntropyLoss.forward() got an unexpected keyword argument 'ignore_index'
debug | INFO flwr 2024-06-26 18:30:38,690 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:30:40,592 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37912829952.0, 'object_store_memory': 18956414976.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'node:__internal_head__': 1.0}
debug | INFO flwr 2024-06-26 18:30:40,592 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:30:40,592 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:30:40,597 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:30:40,597 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:30:40,597 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:30:43,180 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:30:43,180 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:30:43,180 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:30:43,180 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:30:43,180 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:30:44,102 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:44,102 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:44,783 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:44,783 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:45,478 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:45,478 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:46,190 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:46,190 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:46,910 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:46,910 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:47,607 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:47,607 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:48,286 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:48,286 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:48,977 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:48,978 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:49,673 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:49,673 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:50,328 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:50,328 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:30:50,328 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:30:50,328 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:30:51,085 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:51,085 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:51,760 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:51,761 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:52,443 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:52,443 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:53,106 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:53,106 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:53,776 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:53,776 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:54,443 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:54,443 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:55,127 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:55,127 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:55,812 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:55,813 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:56,515 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:56,515 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:30:57,184 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:30:57,184 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 125, in forward
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=192234, ip=172.17.0.2, actor_id=257e7b08eae638d60d7ad84201000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x71c7c07c9f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:31:30,165 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:31:32,062 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'memory': 37912768512.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'object_store_memory': 18956384256.0}
debug | INFO flwr 2024-06-26 18:31:32,063 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:31:32,063 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:31:32,068 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:31:32,068 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:31:32,068 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:31:34,699 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:31:34,699 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:31:34,699 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:31:34,699 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:31:34,699 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:31:35,619 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:35,620 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:36,340 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:36,340 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:37,066 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:37,066 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:37,793 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:37,793 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:38,545 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:38,545 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:39,252 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:39,252 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:39,973 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:39,974 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:40,689 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:40,689 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:41,398 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:41,398 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:42,069 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:42,070 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:31:42,070 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:31:42,070 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:31:42,816 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:42,817 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:43,480 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:43,481 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:44,137 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:44,137 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:44,816 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:44,816 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:45,485 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:45,485 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:46,154 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:46,154 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:46,821 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:46,821 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:47,519 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:47,519 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:48,209 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:48,209 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:48,866 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:48,866 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:31:48,867 | server.py:190 | aggregate_evaluate: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:31:48,867 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:31:48,867 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-26 18:31:48,867 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:31:49,592 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:49,592 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:50,301 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:50,301 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:51,013 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:51,013 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:51,702 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:51,703 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:52,419 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:52,419 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:53,112 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:53,112 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:53,814 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:53,814 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:54,516 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:54,516 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:55,207 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:55,207 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:55,872 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:55,872 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:31:55,872 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:31:55,873 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:31:56,601 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:56,601 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:57,270 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:57,270 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:57,944 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:57,944 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:58,624 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:58,624 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:59,295 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:59,295 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:31:59,966 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:31:59,966 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:00,642 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:00,642 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:01,311 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:01,311 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:01,991 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:01,992 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:02,673 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:02,673 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:32:02,673 | server.py:190 | aggregate_evaluate: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:32:02,673 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:32:02,673 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-26 18:32:02,673 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:32:03,386 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:03,386 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:04,059 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:04,059 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:04,738 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:04,738 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:05,412 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:05,412 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:06,084 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:06,084 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:06,768 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:06,769 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:07,450 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:07,450 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:08,123 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:08,123 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:08,801 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:08,801 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:09,441 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:09,441 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=193453, ip=172.17.0.2, actor_id=d64091a1ea1bd7c7faf4050001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x79b2a47c5f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:32:18,808 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:32:20,678 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18954789273.0, 'node:__internal_head__': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'memory': 37909578548.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-26 18:32:20,678 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:32:20,678 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:32:20,686 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:32:20,686 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:32:20,686 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:32:23,311 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:32:23,312 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:32:23,312 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:32:23,312 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:32:23,312 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:32:24,257 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:24,257 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:24,971 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:24,972 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:25,688 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:25,688 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:26,421 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:26,421 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:27,156 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:27,156 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:27,864 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:27,864 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:28,577 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:28,577 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:29,298 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:29,298 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:30,008 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:30,008 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:30,678 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:30,678 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:32:30,678 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:32:30,679 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:32:31,427 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:31,427 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:32,092 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:32,092 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:32,755 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:32,755 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:33,429 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:33,429 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:34,088 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:34,088 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:34,748 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:34,748 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:35,434 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:35,434 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=194860, ip=172.17.0.2, actor_id=5afa4c5b629ae8597fa4f1b001000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e84d47c5f30>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:32:41,404 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:32:43,335 | app.py:228 | Flower VCE: Ray initialized with resources: {'node:__internal_head__': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'memory': 37909291008.0, 'object_store_memory': 18954645504.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-26 18:32:43,335 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:32:43,335 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:32:43,340 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:32:43,340 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:32:43,340 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:32:45,941 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:32:45,941 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:32:45,941 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:32:45,941 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:32:45,941 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:32:46,867 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:46,867 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:47,577 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:47,577 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:48,291 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:48,291 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:49,003 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:49,003 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:49,756 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:49,756 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:50,474 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:50,474 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:51,184 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:51,184 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:51,876 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:51,876 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:52,568 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:52,568 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:53,253 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:53,253 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:32:53,253 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:32:53,253 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:32:54,033 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:54,033 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:54,707 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:54,707 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:55,404 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:55,404 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:56,079 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:56,079 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:56,761 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:56,761 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:57,433 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:57,433 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:58,126 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:58,126 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:58,811 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:58,811 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:32:59,491 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:32:59,491 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | ERROR flwr 2024-06-26 18:33:00,154 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target

debug | ERROR flwr 2024-06-26 18:33:00,154 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 123, in forward
    loss = self.criterion(sim_matrix, labels) #ignores zero index which
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1185, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/functional.py", line 3086, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
RuntimeError: ignore_index is not supported for floating point target

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=195912, ip=172.17.0.2, actor_id=8a33aea9086b60cd80552fc801000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7e4d98675f60>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: ignore_index is not supported for floating point target
debug | INFO flwr 2024-06-26 18:42:00,673 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:42:02,598 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18951931084.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0, 'memory': 37903862171.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'node:__internal_head__': 1.0}
debug | INFO flwr 2024-06-26 18:42:02,598 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:42:02,599 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:42:02,603 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:42:02,604 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:42:02,604 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:42:05,224 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:42:05,224 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:42:05,224 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:42:05,224 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:42:05,224 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:42:06,136 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:06,136 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:06,820 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:06,820 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:07,509 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:07,509 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:08,200 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:08,200 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:08,904 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:08,904 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:09,588 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:09,588 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:10,268 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:10,268 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:10,948 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:10,949 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:11,632 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:11,633 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:12,271 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:12,271 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | INFO flwr 2024-06-26 18:42:12,271 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:42:12,271 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:42:13,017 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:13,017 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:13,677 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:13,677 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:14,335 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:14,335 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:15,012 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:15,013 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:15,670 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:15,670 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:16,319 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:16,319 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:16,971 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:16,971 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:17,633 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:17,633 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:18,323 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:18,323 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:18,955 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:18,956 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | INFO flwr 2024-06-26 18:42:18,956 | server.py:190 | aggregate_evaluate: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:42:18,956 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:42:18,956 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-26 18:42:18,956 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:42:19,668 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:19,668 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:20,366 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:20,366 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:21,041 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:21,042 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:21,710 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:21,710 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:22,386 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:22,386 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:23,070 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:23,070 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:23,748 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:23,748 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:24,422 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:24,422 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:25,094 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:25,094 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    labels = torch.arange(self.batch_size, 2 * self.batch_size, device=self.device)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:25,743 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:25,743 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 130, in handle_legacy_message_from_msgtype
    fit_res = maybe_call_fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 234, in maybe_call_fit
    return client.fit(fit_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 238, in _fit
    results = self.numpy_client.fit(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 131, in fit
    train(self.simclr, self.trainloader, self.optimizer, ntxent, epochs=1)
  File "/root/src/fedSSL/client.py", line 42, in train
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | INFO flwr 2024-06-26 18:42:25,743 | server.py:238 | aggregate_fit: received 0 results and 10 failures
debug | INFO flwr 2024-06-26 18:42:25,743 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | ERROR flwr 2024-06-26 18:42:26,451 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:26,451 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:27,102 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:27,102 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:27,755 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:27,756 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:28,424 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:28,424 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:29,105 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:29,105 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:29,795 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:29,795 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | ERROR flwr 2024-06-26 18:42:30,480 | ray_client_proxy.py:85 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_client_proxy.py", line 73, in _submit_job
    out_mssg, updated_context = self.actor_pool.get_client_result(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 399, in get_client_result
    return self._fetch_future_result(cid)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 280, in _fetch_future_result
    res_cid, out_mssg, updated_context = ray.get(
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 2667, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/root/myprojectenv/lib/python3.10/site-packages/ray/_private/worker.py", line 864, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(ClientAppException): [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'

debug | ERROR flwr 2024-06-26 18:42:30,480 | ray_client_proxy.py:86 | [36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 98, in __call__
    return self._call(message, context)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client_app.py", line 81, in ffn
    out_message = handle_legacy_message_from_msgtype(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/message_handler/message_handler.py", line 137, in handle_legacy_message_from_msgtype
    evaluate_res = maybe_call_evaluate(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/client.py", line 254, in maybe_call_evaluate
    return client.evaluate(evaluate_ins)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/client/numpy_client.py", line 262, in _evaluate
    results = self.numpy_client.evaluate(parameters, ins.config)  # type: ignore
  File "/root/src/fedSSL/client.py", line 141, in evaluate
    loss, accuracy = test(self.simclr, self.simclr_predictor, testloader, ntxent)
  File "/root/src/fedSSL/client.py", line 90, in test
    loss = criterion(z_i, z_j)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/src/fedSSL/model.py", line 119, in forward
    # Labels for each entry
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'NTXentLoss' object has no attribute 'batch_size'

The above exception was the direct cause of the following exception:

[36mray::ClientAppActor.run()[39m (pid=198711, ip=172.17.0.2, actor_id=1a88dd7a1c22b888f5c475d901000000, repr=<flwr.simulation.ray_transport.ray_actor.ClientAppActor object at 0x7579007b5f00>)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/ray_transport/ray_actor.py", line 64, in run
    raise ClientAppException(str(ex)) from ex
flwr.client.client_app.ClientAppException: 
Exception ClientAppException occurred. Message: 'NTXentLoss' object has no attribute 'batch_size'
debug | INFO flwr 2024-06-26 18:42:38,283 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:42:40,171 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18950737920.0, 'node:__internal_head__': 1.0, 'memory': 37901475840.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'accelerator_type:G': 1.0, 'GPU': 1.0}
debug | INFO flwr 2024-06-26 18:42:40,171 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:42:40,171 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:42:40,176 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:42:40,177 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:42:40,177 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:42:42,790 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:42:42,790 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:42:42,790 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:42:42,790 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:42:42,790 | server.py:224 | configure_fit: strategy sampled 10 clients (out of 10)
debug | INFO flwr 2024-06-26 18:43:31,632 | server.py:238 | aggregate_fit: received 10 results and 0 failures
debug | WARNING flwr 2024-06-26 18:43:32,036 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-26 18:43:32,036 | server.py:176 | configure_evaluate: strategy sampled 10 clients (out of 10)
debug | INFO flwr 2024-06-26 18:45:10,711 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-26 18:45:12,606 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18954161356.0, 'node:__internal_head__': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'memory': 37908322715.0}
debug | INFO flwr 2024-06-26 18:45:12,606 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-26 18:45:12,606 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-26 18:45:12,611 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-26 18:45:12,611 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-26 18:45:12,611 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-26 18:45:15,225 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-26 18:45:15,225 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-26 18:45:15,225 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:45:15,225 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-26 18:45:15,226 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-26 18:46:01,835 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | WARNING flwr 2024-06-26 18:46:01,936 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-26 18:46:01,937 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-26 18:46:20,298 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | WARNING flwr 2024-06-26 18:46:20,298 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-26 18:46:20,298 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:46:20,298 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-26 18:46:20,298 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-26 18:47:06,341 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-26 18:47:06,438 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-26 18:47:24,783 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-26 18:47:24,783 | server.py:110 | 
debug | INFO flwr 2024-06-26 18:47:24,783 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-26 18:47:24,783 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-26 18:48:10,711 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-26 18:48:10,780 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-26 18:48:28,931 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-26 18:48:28,933 | server.py:494 | 
debug | INFO flwr 2024-06-26 18:48:28,933 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-26 18:48:28,933 | server.py:496 | Run finished 3 round(s) in 193.71s
debug | INFO flwr 2024-06-26 18:48:28,933 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-26 18:48:28,934 | server.py:498 | 		round 1: 5.985895192623138
debug | INFO flwr 2024-06-26 18:48:28,934 | server.py:498 | 		round 2: 5.86846284866333
debug | INFO flwr 2024-06-26 18:48:28,934 | server.py:498 | 		round 3: 5.820194244384766
debug | INFO flwr 2024-06-26 18:48:28,934 | server.py:499 | 
debug | INFO flwr 2024-06-27 20:11:05,683 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 20:11:07,584 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37980055143.0, 'object_store_memory': 18990027571.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'node:__internal_head__': 1.0}
debug | INFO flwr 2024-06-27 20:11:07,584 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 20:11:07,584 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 20:11:07,589 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 20:11:07,589 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 20:11:07,589 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 20:11:10,213 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 20:11:10,213 | server.py:94 | Evaluating initial global parameters
debug | INFO flwr 2024-06-27 20:11:10,213 | server.py:110 | 
debug | INFO flwr 2024-06-27 20:11:10,213 | server.py:111 | [ROUND 1]
debug | INFO flwr 2024-06-27 20:11:10,213 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 20:11:56,855 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | WARNING flwr 2024-06-27 20:11:56,956 | fedavg.py:252 | No fit_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-27 20:11:56,957 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 20:12:15,452 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | WARNING flwr 2024-06-27 20:12:15,452 | fedavg.py:283 | No evaluate_metrics_aggregation_fn provided
debug | INFO flwr 2024-06-27 20:12:15,452 | server.py:110 | 
debug | INFO flwr 2024-06-27 20:12:15,452 | server.py:111 | [ROUND 2]
debug | INFO flwr 2024-06-27 20:12:15,452 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 20:13:01,816 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 20:13:01,913 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 20:13:20,419 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 20:13:20,419 | server.py:110 | 
debug | INFO flwr 2024-06-27 20:13:20,419 | server.py:111 | [ROUND 3]
debug | INFO flwr 2024-06-27 20:13:20,419 | server.py:224 | configure_fit: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 20:14:06,320 | server.py:238 | aggregate_fit: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 20:14:06,390 | server.py:176 | configure_evaluate: strategy sampled 2 clients (out of 2)
debug | INFO flwr 2024-06-27 20:14:24,712 | server.py:190 | aggregate_evaluate: received 2 results and 0 failures
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:494 | 
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:495 | [SUMMARY]
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:496 | Run finished 3 round(s) in 194.50s
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:498 | 	History (loss, distributed):
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:498 | 		round 1: 5.971367681026459
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:498 | 		round 2: 5.859543812274933
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:498 | 		round 3: 5.822723925113678
debug | INFO flwr 2024-06-27 20:14:24,714 | server.py:499 | 
debug | INFO flwr 2024-06-27 22:18:07,092 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:18:08,972 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18992866099.0, 'node:__internal_head__': 1.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'memory': 37985732199.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0}
debug | INFO flwr 2024-06-27 22:18:08,972 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:18:08,972 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:18:08,977 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:18:08,977 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:18:08,977 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:18:11,577 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:18:11,578 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:18:11,601 | app.py:328 | SimCLRPredictor.set_encoder_parameters() takes 1 positional argument but 2 were given
debug | ERROR flwr 2024-06-27 22:18:11,601 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 38, in evaluate
    self.update_encoder(parameters)
  File "/root/src/fedSSL/server.py", line 99, in update_encoder
    self.simclr_predictor.set_encoder_parameters(weights)
TypeError: SimCLRPredictor.set_encoder_parameters() takes 1 positional argument but 2 were given

debug | ERROR flwr 2024-06-27 22:18:11,601 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:18:35,058 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:18:36,970 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37986368718.0, 'node:__internal_head__': 1.0, 'object_store_memory': 18993184358.0, 'node:172.17.0.2': 1.0, 'CPU': 11.0, 'accelerator_type:G': 1.0, 'GPU': 1.0}
debug | INFO flwr 2024-06-27 22:18:36,970 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:18:36,970 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:18:36,975 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:18:36,975 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:18:36,975 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:18:39,548 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:18:39,548 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:18:39,571 | app.py:328 | 'SimCLR' object has no attribute 'set_weights'
debug | ERROR flwr 2024-06-27 22:18:39,572 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 38, in evaluate
    self.update_encoder(parameters)
  File "/root/src/fedSSL/server.py", line 99, in update_encoder
    self.simclr_predictor.set_encoder_parameters(weights)
  File "/root/src/fedSSL/model.py", line 132, in set_encoder_parameters
    self.simclr.set_weights(weights)
  File "/root/myprojectenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1709, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'SimCLR' object has no attribute 'set_weights'

debug | ERROR flwr 2024-06-27 22:18:39,572 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:19:45,601 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:19:47,540 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 18993455923.0, 'node:__internal_head__': 1.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'memory': 37986911847.0}
debug | INFO flwr 2024-06-27 22:19:47,540 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:19:47,540 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:19:47,545 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:19:47,545 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:19:47,545 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:19:50,152 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:19:50,152 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:19:50,176 | app.py:328 | name 'parameters' is not defined
debug | ERROR flwr 2024-06-27 22:19:50,177 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 38, in evaluate
    self.update_encoder(parameters)
  File "/root/src/fedSSL/server.py", line 99, in update_encoder
    self.simclr_predictor.set_encoder_parameters(weights)
  File "/root/src/fedSSL/model.py", line 133, in set_encoder_parameters
    params_dict = zip(self.simclr.state_dict().keys(), parameters)
NameError: name 'parameters' is not defined

debug | ERROR flwr 2024-06-27 22:19:50,177 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:20:02,149 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:20:04,062 | app.py:228 | Flower VCE: Ray initialized with resources: {'object_store_memory': 19011311616.0, 'node:__internal_head__': 1.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'accelerator_type:G': 1.0, 'GPU': 1.0, 'memory': 38022623232.0}
debug | INFO flwr 2024-06-27 22:20:04,062 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:20:04,062 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:20:04,067 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:20:04,067 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:20:04,067 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:20:06,622 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:20:06,622 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:20:49,290 | app.py:328 | name 'output' is not defined
debug | ERROR flwr 2024-06-27 22:20:49,290 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 41, in evaluate
    accuracy = self.evaluate()
  File "/root/src/fedSSL/server.py", line 85, in evaluate
    predicted = torch.max(output, 1)
NameError: name 'output' is not defined

debug | ERROR flwr 2024-06-27 22:20:49,290 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:21:05,697 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:21:07,596 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37987302606.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'object_store_memory': 18993651302.0, 'GPU': 1.0, 'accelerator_type:G': 1.0, 'node:__internal_head__': 1.0}
debug | INFO flwr 2024-06-27 22:21:07,596 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:21:07,596 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:21:07,601 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:21:07,601 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:21:07,601 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:21:10,170 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:21:10,170 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:21:52,467 | app.py:328 | name 'outputs' is not defined
debug | ERROR flwr 2024-06-27 22:21:52,468 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 41, in evaluate
    accuracy = self.evaluate()
  File "/root/src/fedSSL/server.py", line 87, in evaluate
    predicted = torch.max(outputs, 1)
NameError: name 'outputs' is not defined

debug | ERROR flwr 2024-06-27 22:21:52,468 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:22:45,166 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:22:47,082 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37986398208.0, 'object_store_memory': 18993199104.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'node:__internal_head__': 1.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-27 22:22:47,082 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:22:47,082 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:22:47,087 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:22:47,087 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:22:47,087 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:22:49,653 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:22:49,653 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:23:32,194 | app.py:328 | 'torch.Size' object is not callable
debug | ERROR flwr 2024-06-27 22:23:32,194 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 41, in evaluate
    accuracy = self.evaluate()
  File "/root/src/fedSSL/server.py", line 89, in evaluate
    total += labels.shape(0)
TypeError: 'torch.Size' object is not callable

debug | ERROR flwr 2024-06-27 22:23:32,194 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
debug | INFO flwr 2024-06-27 22:26:45,707 | app.py:193 | Starting Flower simulation, config: num_rounds=3, no round_timeout
debug | INFO flwr 2024-06-27 22:26:47,608 | app.py:228 | Flower VCE: Ray initialized with resources: {'memory': 37985461863.0, 'CPU': 11.0, 'node:172.17.0.2': 1.0, 'node:__internal_head__': 1.0, 'object_store_memory': 18992730931.0, 'GPU': 1.0, 'accelerator_type:G': 1.0}
debug | INFO flwr 2024-06-27 22:26:47,608 | app.py:234 | Optimize your simulation with Flower VCE: https://flower.ai/docs/framework/how-to-run-simulations.html
debug | INFO flwr 2024-06-27 22:26:47,608 | app.py:257 | Flower VCE: Resources for each Virtual Client: {'num_cpus': 8, 'num_gpus': 1.0}
debug | INFO flwr 2024-06-27 22:26:47,613 | app.py:303 | Flower VCE: Creating VirtualClientEngineActorPool with 1 actors
debug | INFO flwr 2024-06-27 22:26:47,613 | server.py:92 | [INIT]
debug | INFO flwr 2024-06-27 22:26:47,613 | server.py:279 | Requesting initial parameters from one random client
debug | INFO flwr 2024-06-27 22:26:50,219 | server.py:286 | Received initial parameters from one random client
debug | INFO flwr 2024-06-27 22:26:50,219 | server.py:94 | Evaluating initial global parameters
debug | ERROR flwr 2024-06-27 22:27:32,770 | app.py:328 | 'bool' object has no attribute 'sum'
debug | ERROR flwr 2024-06-27 22:27:32,770 | app.py:329 | Traceback (most recent call last):
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/simulation/app.py", line 323, in start_simulation
    hist = run_fl(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 490, in run_fl
    hist, elapsed_time = server.fit(
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/server.py", line 95, in fit
    res = self.strategy.evaluate(0, parameters=self.parameters)
  File "/root/myprojectenv/lib/python3.10/site-packages/flwr/server/strategy/fedavg.py", line 167, in evaluate
    eval_res = self.evaluate_fn(server_round, parameters_ndarrays, {})
  File "/root/src/fedSSL/server.py", line 41, in evaluate
    accuracy = self.evaluate()
  File "/root/src/fedSSL/server.py", line 90, in evaluate
    correct += (predicted == labels).sum().item()
AttributeError: 'bool' object has no attribute 'sum'

debug | ERROR flwr 2024-06-27 22:27:32,770 | app.py:330 | Your simulation crashed :(. This could be because of several reasons. The most common are: 
	 > Sometimes, issues in the simulation code itself can cause crashes. It's always a good idea to double-check your code for any potential bugs or inconsistencies that might be contributing to the problem. For example: 
		 - You might be using a class attribute in your clients that hasn't been defined.
		 - There could be an incorrect method call to a 3rd party library (e.g., PyTorch).
		 - The return types of methods in your clients/strategies might be incorrect.
	 > Your system couldn't fit a single VirtualClient: try lowering `client_resources`.
	 > All the actors in your pool crashed. This could be because: 
		 - You clients hit an out-of-memory (OOM) error and actors couldn't recover from it. Try launching your simulation with more generous `client_resources` setting (i.e. it seems {'num_cpus': 8, 'num_gpus': 1.0} is not enough for your run). Use fewer concurrent actors. 
		 - You were running a multi-node simulation and all worker nodes disconnected. The head node might still be alive but cannot accommodate any actor with resources: {'num_cpus': 8, 'num_gpus': 1.0}.
Take a look at the Flower simulation examples for guidance <https://flower.ai/docs/framework/how-to-run-simulations.html>.
